{"version":3,"file":"Dz2bbB3I.js","sources":["../../../../../../node_modules/wheel/index.js","../../../../../../node_modules/bezier-easing/src/index.js","../../../../../../node_modules/amator/index.js","../../../../../../node_modules/ngraph.events/index.js","../../../../../../node_modules/panzoom/lib/kinetic.js","../../../../../../node_modules/panzoom/lib/createTextSelectionInterceptor.js","../../../../../../node_modules/panzoom/lib/transform.js","../../../../../../node_modules/panzoom/lib/svgController.js","../../../../../../node_modules/panzoom/lib/domController.js","../../../../../../node_modules/panzoom/index.js","../../../../../../src/lib/components/common/ImagePreview.svelte","../../../../../../src/lib/components/common/Image.svelte"],"sourcesContent":["/**\n * This module used to unify mouse wheel behavior between different browsers in 2014\n * Now it's just a wrapper around addEventListener('wheel');\n *\n * Usage:\n *  var addWheelListener = require('wheel').addWheelListener;\n *  var removeWheelListener = require('wheel').removeWheelListener;\n *  addWheelListener(domElement, function (e) {\n *    // mouse wheel event\n *  });\n *  removeWheelListener(domElement, function);\n */\n\nmodule.exports = addWheelListener;\n\n// But also expose \"advanced\" api with unsubscribe:\nmodule.exports.addWheelListener = addWheelListener;\nmodule.exports.removeWheelListener = removeWheelListener;\n\n\nfunction addWheelListener(element, listener, useCapture) {\n  element.addEventListener('wheel', listener, useCapture);\n}\n\nfunction removeWheelListener( element, listener, useCapture ) {\n  element.removeEventListener('wheel', listener, useCapture);\n}","/**\n * https://github.com/gre/bezier-easing\n * BezierEasing - use bezier curve for transition easing function\n * by Gaëtan Renaudeau 2014 - 2015 – MIT License\n */\n\n// These values are established by empiricism with tests (tradeoff: performance VS precision)\nvar NEWTON_ITERATIONS = 4;\nvar NEWTON_MIN_SLOPE = 0.001;\nvar SUBDIVISION_PRECISION = 0.0000001;\nvar SUBDIVISION_MAX_ITERATIONS = 10;\n\nvar kSplineTableSize = 11;\nvar kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\nvar float32ArraySupported = typeof Float32Array === 'function';\n\nfunction A (aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1; }\nfunction B (aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1; }\nfunction C (aA1)      { return 3.0 * aA1; }\n\n// Returns x(t) given t, x1, and x2, or y(t) given t, y1, and y2.\nfunction calcBezier (aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT; }\n\n// Returns dx/dt given t, x1, and x2, or dy/dt given t, y1, and y2.\nfunction getSlope (aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1); }\n\nfunction binarySubdivide (aX, aA, aB, mX1, mX2) {\n  var currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2.0;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0.0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (Math.abs(currentX) > SUBDIVISION_PRECISION && ++i < SUBDIVISION_MAX_ITERATIONS);\n  return currentT;\n}\n\nfunction newtonRaphsonIterate (aX, aGuessT, mX1, mX2) {\n for (var i = 0; i < NEWTON_ITERATIONS; ++i) {\n   var currentSlope = getSlope(aGuessT, mX1, mX2);\n   if (currentSlope === 0.0) {\n     return aGuessT;\n   }\n   var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n   aGuessT -= currentX / currentSlope;\n }\n return aGuessT;\n}\n\nfunction LinearEasing (x) {\n  return x;\n}\n\nmodule.exports = function bezier (mX1, mY1, mX2, mY2) {\n  if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) {\n    throw new Error('bezier x values must be in [0, 1] range');\n  }\n\n  if (mX1 === mY1 && mX2 === mY2) {\n    return LinearEasing;\n  }\n\n  // Precompute samples table\n  var sampleValues = float32ArraySupported ? new Float32Array(kSplineTableSize) : new Array(kSplineTableSize);\n  for (var i = 0; i < kSplineTableSize; ++i) {\n    sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n  }\n\n  function getTForX (aX) {\n    var intervalStart = 0.0;\n    var currentSample = 1;\n    var lastSample = kSplineTableSize - 1;\n\n    for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n      intervalStart += kSampleStepSize;\n    }\n    --currentSample;\n\n    // Interpolate to provide an initial guess for t\n    var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n    var guessForT = intervalStart + dist * kSampleStepSize;\n\n    var initialSlope = getSlope(guessForT, mX1, mX2);\n    if (initialSlope >= NEWTON_MIN_SLOPE) {\n      return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n    } else if (initialSlope === 0.0) {\n      return guessForT;\n    } else {\n      return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n    }\n  }\n\n  return function BezierEasing (x) {\n    // Because JavaScript number are imprecise, we should guarantee the extremes are right.\n    if (x === 0) {\n      return 0;\n    }\n    if (x === 1) {\n      return 1;\n    }\n    return calcBezier(getTForX(x), mY1, mY2);\n  };\n};\n","var BezierEasing = require('bezier-easing')\n\n// Predefined set of animations. Similar to CSS easing functions\nvar animations = {\n  ease:  BezierEasing(0.25, 0.1, 0.25, 1),\n  easeIn: BezierEasing(0.42, 0, 1, 1),\n  easeOut: BezierEasing(0, 0, 0.58, 1),\n  easeInOut: BezierEasing(0.42, 0, 0.58, 1),\n  linear: BezierEasing(0, 0, 1, 1)\n}\n\n\nmodule.exports = animate;\nmodule.exports.makeAggregateRaf = makeAggregateRaf;\nmodule.exports.sharedScheduler = makeAggregateRaf();\n\n\nfunction animate(source, target, options) {\n  var start = Object.create(null)\n  var diff = Object.create(null)\n  options = options || {}\n  // We let clients specify their own easing function\n  var easing = (typeof options.easing === 'function') ? options.easing : animations[options.easing]\n\n  // if nothing is specified, default to ease (similar to CSS animations)\n  if (!easing) {\n    if (options.easing) {\n      console.warn('Unknown easing function in amator: ' + options.easing);\n    }\n    easing = animations.ease\n  }\n\n  var step = typeof options.step === 'function' ? options.step : noop\n  var done = typeof options.done === 'function' ? options.done : noop\n\n  var scheduler = getScheduler(options.scheduler)\n\n  var keys = Object.keys(target)\n  keys.forEach(function(key) {\n    start[key] = source[key]\n    diff[key] = target[key] - source[key]\n  })\n\n  var durationInMs = typeof options.duration === 'number' ? options.duration : 400\n  var durationInFrames = Math.max(1, durationInMs * 0.06) // 0.06 because 60 frames pers 1,000 ms\n  var previousAnimationId\n  var frame = 0\n\n  previousAnimationId = scheduler.next(loop)\n\n  return {\n    cancel: cancel\n  }\n\n  function cancel() {\n    scheduler.cancel(previousAnimationId)\n    previousAnimationId = 0\n  }\n\n  function loop() {\n    var t = easing(frame/durationInFrames)\n    frame += 1\n    setValues(t)\n    if (frame <= durationInFrames) {\n      previousAnimationId = scheduler.next(loop)\n      step(source)\n    } else {\n      previousAnimationId = 0\n      setTimeout(function() { done(source) }, 0)\n    }\n  }\n\n  function setValues(t) {\n    keys.forEach(function(key) {\n      source[key] = diff[key] * t + start[key]\n    })\n  }\n}\n\nfunction noop() { }\n\nfunction getScheduler(scheduler) {\n  if (!scheduler) {\n    var canRaf = typeof window !== 'undefined' && window.requestAnimationFrame\n    return canRaf ? rafScheduler() : timeoutScheduler()\n  }\n  if (typeof scheduler.next !== 'function') throw new Error('Scheduler is supposed to have next(cb) function')\n  if (typeof scheduler.cancel !== 'function') throw new Error('Scheduler is supposed to have cancel(handle) function')\n\n  return scheduler\n}\n\nfunction rafScheduler() {\n  return {\n    next: window.requestAnimationFrame.bind(window),\n    cancel: window.cancelAnimationFrame.bind(window)\n  }\n}\n\nfunction timeoutScheduler() {\n  return {\n    next: function(cb) {\n      return setTimeout(cb, 1000/60)\n    },\n    cancel: function (id) {\n      return clearTimeout(id)\n    }\n  }\n}\n\nfunction makeAggregateRaf() {\n  var frontBuffer = new Set();\n  var backBuffer = new Set();\n  var frameToken = 0;\n\n  return {\n    next: next,\n    cancel: next,\n    clearAll: clearAll\n  }\n\n  function clearAll() {\n    frontBuffer.clear();\n    backBuffer.clear();\n    cancelAnimationFrame(frameToken);\n    frameToken = 0;\n  }\n\n  function next(callback) {\n    backBuffer.add(callback);\n    renderNextFrame();\n  }\n\n  function renderNextFrame() {\n    if (!frameToken) frameToken = requestAnimationFrame(renderFrame);\n  }\n\n  function renderFrame() {\n    frameToken = 0;\n\n    var t = backBuffer;\n    backBuffer = frontBuffer;\n    frontBuffer = t;\r\n\n    frontBuffer.forEach(function(callback) {\n      callback();\n    });\n    frontBuffer.clear();\n  }\n\n  function cancel(callback) {\n    backBuffer.delete(callback);\n  }\n}\n","module.exports = function eventify(subject) {\n  validateSubject(subject);\n\n  var eventsStorage = createEventsStorage(subject);\n  subject.on = eventsStorage.on;\n  subject.off = eventsStorage.off;\n  subject.fire = eventsStorage.fire;\n  return subject;\n};\n\nfunction createEventsStorage(subject) {\n  // Store all event listeners to this hash. Key is event name, value is array\n  // of callback records.\n  //\n  // A callback record consists of callback function and its optional context:\n  // { 'eventName' => [{callback: function, ctx: object}] }\n  var registeredEvents = Object.create(null);\n\n  return {\n    on: function (eventName, callback, ctx) {\n      if (typeof callback !== 'function') {\n        throw new Error('callback is expected to be a function');\n      }\n      var handlers = registeredEvents[eventName];\n      if (!handlers) {\n        handlers = registeredEvents[eventName] = [];\n      }\n      handlers.push({callback: callback, ctx: ctx});\n\n      return subject;\n    },\n\n    off: function (eventName, callback) {\n      var wantToRemoveAll = (typeof eventName === 'undefined');\n      if (wantToRemoveAll) {\n        // Killing old events storage should be enough in this case:\n        registeredEvents = Object.create(null);\n        return subject;\n      }\n\n      if (registeredEvents[eventName]) {\n        var deleteAllCallbacksForEvent = (typeof callback !== 'function');\n        if (deleteAllCallbacksForEvent) {\n          delete registeredEvents[eventName];\n        } else {\n          var callbacks = registeredEvents[eventName];\n          for (var i = 0; i < callbacks.length; ++i) {\n            if (callbacks[i].callback === callback) {\n              callbacks.splice(i, 1);\n            }\n          }\n        }\n      }\n\n      return subject;\n    },\n\n    fire: function (eventName) {\n      var callbacks = registeredEvents[eventName];\n      if (!callbacks) {\n        return subject;\n      }\n\n      var fireArguments;\n      if (arguments.length > 1) {\n        fireArguments = Array.prototype.splice.call(arguments, 1);\n      }\n      for(var i = 0; i < callbacks.length; ++i) {\n        var callbackInfo = callbacks[i];\n        callbackInfo.callback.apply(callbackInfo.ctx, fireArguments);\n      }\n\n      return subject;\n    }\n  };\n}\n\nfunction validateSubject(subject) {\n  if (!subject) {\n    throw new Error('Eventify cannot use falsy object as events subject');\n  }\n  var reservedWords = ['on', 'fire', 'off'];\n  for (var i = 0; i < reservedWords.length; ++i) {\n    if (subject.hasOwnProperty(reservedWords[i])) {\n      throw new Error(\"Subject cannot be eventified, since it already has property '\" + reservedWords[i] + \"'\");\n    }\n  }\n}\n","/**\n * Allows smooth kinetic scrolling of the surface\n */\nmodule.exports = kinetic;\n\nfunction kinetic(getPoint, scroll, settings) {\n  if (typeof settings !== 'object') {\n    // setting could come as boolean, we should ignore it, and use an object.\n    settings = {};\n  }\n\n  var minVelocity = typeof settings.minVelocity === 'number' ? settings.minVelocity : 5;\n  var amplitude = typeof settings.amplitude === 'number' ? settings.amplitude : 0.25;\n  var cancelAnimationFrame = typeof settings.cancelAnimationFrame === 'function' ? settings.cancelAnimationFrame : getCancelAnimationFrame();\n  var requestAnimationFrame = typeof settings.requestAnimationFrame === 'function' ? settings.requestAnimationFrame : getRequestAnimationFrame();\n\n  var lastPoint;\n  var timestamp;\n  var timeConstant = 342;\n\n  var ticker;\n  var vx, targetX, ax;\n  var vy, targetY, ay;\n\n  var raf;\n\n  return {\n    start: start,\n    stop: stop,\n    cancel: dispose\n  };\n\n  function dispose() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n  }\n\n  function start() {\n    lastPoint = getPoint();\n\n    ax = ay = vx = vy = 0;\n    timestamp = new Date();\n\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    // we start polling the point position to accumulate velocity\n    // Once we stop(), we will use accumulated velocity to keep scrolling\n    // an object.\n    ticker = requestAnimationFrame(track);\n  }\n\n  function track() {\n    var now = Date.now();\n    var elapsed = now - timestamp;\n    timestamp = now;\n\n    var currentPoint = getPoint();\n\n    var dx = currentPoint.x - lastPoint.x;\n    var dy = currentPoint.y - lastPoint.y;\n\n    lastPoint = currentPoint;\n\n    var dt = 1000 / (1 + elapsed);\n\n    // moving average\n    vx = 0.8 * dx * dt + 0.2 * vx;\n    vy = 0.8 * dy * dt + 0.2 * vy;\n\n    ticker = requestAnimationFrame(track);\n  }\n\n  function stop() {\n    cancelAnimationFrame(ticker);\n    cancelAnimationFrame(raf);\n\n    var currentPoint = getPoint();\n\n    targetX = currentPoint.x;\n    targetY = currentPoint.y;\n    timestamp = Date.now();\n\n    if (vx < -minVelocity || vx > minVelocity) {\n      ax = amplitude * vx;\n      targetX += ax;\n    }\n\n    if (vy < -minVelocity || vy > minVelocity) {\n      ay = amplitude * vy;\n      targetY += ay;\n    }\n\n    raf = requestAnimationFrame(autoScroll);\n  }\n\n  function autoScroll() {\n    var elapsed = Date.now() - timestamp;\n\n    var moving = false;\n    var dx = 0;\n    var dy = 0;\n\n    if (ax) {\n      dx = -ax * Math.exp(-elapsed / timeConstant);\n\n      if (dx > 0.5 || dx < -0.5) moving = true;\n      else dx = ax = 0;\n    }\n\n    if (ay) {\n      dy = -ay * Math.exp(-elapsed / timeConstant);\n\n      if (dy > 0.5 || dy < -0.5) moving = true;\n      else dy = ay = 0;\n    }\n\n    if (moving) {\n      scroll(targetX + dx, targetY + dy);\n      raf = requestAnimationFrame(autoScroll);\n    }\n  }\n}\n\nfunction getCancelAnimationFrame() {\n  if (typeof cancelAnimationFrame === 'function') return cancelAnimationFrame;\n  return clearTimeout;\n}\n\nfunction getRequestAnimationFrame() {\n  if (typeof requestAnimationFrame === 'function') return requestAnimationFrame;\n\n  return function (handler) {\n    return setTimeout(handler, 16);\n  };\n}","/**\n * Disallows selecting text.\n */\nmodule.exports = createTextSelectionInterceptor;\n\nfunction createTextSelectionInterceptor(useFake) {\n  if (useFake) {\n    return {\n      capture: noop,\n      release: noop\n    };\n  }\n\n  var dragObject;\n  var prevSelectStart;\n  var prevDragStart;\n  var wasCaptured = false;\n\n  return {\n    capture: capture,\n    release: release\n  };\n\n  function capture(domObject) {\n    wasCaptured = true;\n    prevSelectStart = window.document.onselectstart;\n    prevDragStart = window.document.ondragstart;\n\n    window.document.onselectstart = disabled;\n\n    dragObject = domObject;\n    dragObject.ondragstart = disabled;\n  }\n\n  function release() {\n    if (!wasCaptured) return;\n    \n    wasCaptured = false;\n    window.document.onselectstart = prevSelectStart;\n    if (dragObject) dragObject.ondragstart = prevDragStart;\n  }\n}\n\nfunction disabled(e) {\n  e.stopPropagation();\n  return false;\n}\n\nfunction noop() {}\n","module.exports = Transform;\n\nfunction Transform() {\n  this.x = 0;\n  this.y = 0;\n  this.scale = 1;\n}\n","module.exports = makeSvgController;\nmodule.exports.canAttach = isSVGElement;\n\nfunction makeSvgController(svgElement, options) {\n  if (!isSVGElement(svgElement)) {\n    throw new Error('svg element is required for svg.panzoom to work');\n  }\n\n  var owner = svgElement.ownerSVGElement;\n  if (!owner) {\n    throw new Error(\n      'Do not apply panzoom to the root <svg> element. ' +\n      'Use its child instead (e.g. <g></g>). ' +\n      'As of March 2016 only FireFox supported transform on the root element');\n  }\n\n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getScreenCTM: getScreenCTM,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n    initTransform: initTransform\n  };\n  \n  return api;\n\n  function getOwner() {\n    return owner;\n  }\n\n  function getBBox() {\n    var bbox =  svgElement.getBBox();\n    return {\n      left: bbox.x,\n      top: bbox.y,\n      width: bbox.width,\n      height: bbox.height,\n    };\n  }\n\n  function getScreenCTM() {\n    var ctm = owner.getCTM();\n    if (!ctm) {\n      // This is likely firefox: https://bugzilla.mozilla.org/show_bug.cgi?id=873106\n      // The code below is not entirely correct, but still better than nothing\n      return owner.getScreenCTM();\n    }\n    return ctm;\n  }\n\n  function initTransform(transform) {\n    var screenCTM = svgElement.getCTM();\n\n    // The above line returns null on Firefox\n    if (screenCTM === null) {\n      screenCTM = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\").createSVGMatrix();\n    }\n\n    transform.x = screenCTM.e;\n    transform.y = screenCTM.f;\n    transform.scale = screenCTM.a;\n    owner.removeAttributeNS(null, 'viewBox');\n  }\n\n  function applyTransform(transform) {\n    svgElement.setAttribute('transform', 'matrix(' +\n      transform.scale + ' 0 0 ' +\n      transform.scale + ' ' +\n      transform.x + ' ' + transform.y + ')');\n  }\n}\n\nfunction isSVGElement(element) {\n  return element && element.ownerSVGElement && element.getCTM;\n}","module.exports = makeDomController;\n\nmodule.exports.canAttach = isDomElement;\n\nfunction makeDomController(domElement, options) {\n  var elementValid = isDomElement(domElement); \n  if (!elementValid) {\n    throw new Error('panzoom requires DOM element to be attached to the DOM tree');\n  }\n\n  var owner = domElement.parentElement;\n  domElement.scrollTop = 0;\n  \n  if (!options.disableKeyboardInteraction) {\n    owner.setAttribute('tabindex', 0);\n  }\n\n  var api = {\n    getBBox: getBBox,\n    getOwner: getOwner,\n    applyTransform: applyTransform,\n  };\n  \n  return api;\n\n  function getOwner() {\n    return owner;\n  }\n\n  function getBBox() {\n    // TODO: We should probably cache this?\n    return  {\n      left: 0,\n      top: 0,\n      width: domElement.clientWidth,\n      height: domElement.clientHeight\n    };\n  }\n\n  function applyTransform(transform) {\n    // TODO: Should we cache this?\n    domElement.style.transformOrigin = '0 0 0';\n    domElement.style.transform = 'matrix(' +\n      transform.scale + ', 0, 0, ' +\n      transform.scale + ', ' +\n      transform.x + ', ' + transform.y + ')';\n  }\n}\n\nfunction isDomElement(element) {\n  return element && element.parentElement && element.style;\n}\n","'use strict';\n/**\n * Allows to drag and zoom svg elements\n */\nvar wheel = require('wheel');\nvar animate = require('amator');\nvar eventify = require('ngraph.events');\nvar kinetic = require('./lib/kinetic.js');\nvar createTextSelectionInterceptor = require('./lib/createTextSelectionInterceptor.js');\nvar domTextSelectionInterceptor = createTextSelectionInterceptor();\nvar fakeTextSelectorInterceptor = createTextSelectionInterceptor(true);\nvar Transform = require('./lib/transform.js');\nvar makeSvgController = require('./lib/svgController.js');\nvar makeDomController = require('./lib/domController.js');\n\nvar defaultZoomSpeed = 1;\nvar defaultDoubleTapZoomSpeed = 1.75;\nvar doubleTapSpeedInMS = 300;\nvar clickEventTimeInMS = 200;\n\nmodule.exports = createPanZoom;\n\n/**\n * Creates a new instance of panzoom, so that an object can be panned and zoomed\n *\n * @param {DOMElement} domElement where panzoom should be attached.\n * @param {Object} options that configure behavior.\n */\nfunction createPanZoom(domElement, options) {\n  options = options || {};\n\n  var panController = options.controller;\n\n  if (!panController) {\n    if (makeSvgController.canAttach(domElement)) {\n      panController = makeSvgController(domElement, options);\n    } else if (makeDomController.canAttach(domElement)) {\n      panController = makeDomController(domElement, options);\n    }\n  }\n\n  if (!panController) {\n    throw new Error(\n      'Cannot create panzoom for the current type of dom element'\n    );\n  }\n  var owner = panController.getOwner();\n  // just to avoid GC pressure, every time we do intermediate transform\n  // we return this object. For internal use only. Never give it back to the consumer of this library\n  var storedCTMResult = { x: 0, y: 0 };\n\n  var isDirty = false;\n  var transform = new Transform();\n\n  if (panController.initTransform) {\n    panController.initTransform(transform);\n  }\n\n  var filterKey = typeof options.filterKey === 'function' ? options.filterKey : noop;\n  // TODO: likely need to unite pinchSpeed with zoomSpeed\n  var pinchSpeed = typeof options.pinchSpeed === 'number' ? options.pinchSpeed : 1;\n  var bounds = options.bounds;\n  var maxZoom = typeof options.maxZoom === 'number' ? options.maxZoom : Number.POSITIVE_INFINITY;\n  var minZoom = typeof options.minZoom === 'number' ? options.minZoom : 0;\n\n  var boundsPadding = typeof options.boundsPadding === 'number' ? options.boundsPadding : 0.05;\n  var zoomDoubleClickSpeed = typeof options.zoomDoubleClickSpeed === 'number' ? options.zoomDoubleClickSpeed : defaultDoubleTapZoomSpeed;\n  var beforeWheel = options.beforeWheel || noop;\n  var beforeMouseDown = options.beforeMouseDown || noop;\n  var speed = typeof options.zoomSpeed === 'number' ? options.zoomSpeed : defaultZoomSpeed;\n  var transformOrigin = parseTransformOrigin(options.transformOrigin);\n  var textSelection = options.enableTextSelection ? fakeTextSelectorInterceptor : domTextSelectionInterceptor;\n\n  validateBounds(bounds);\n\n  if (options.autocenter) {\n    autocenter();\n  }\n\n  var frameAnimation;\n  var lastTouchEndTime = 0;\n  var lastTouchStartTime = 0;\n  var pendingClickEventTimeout = 0;\n  var lastMouseDownedEvent = null;\n  var lastMouseDownTime = new Date();\n  var lastSingleFingerOffset;\n  var touchInProgress = false;\n\n  // We only need to fire panstart when actual move happens\n  var panstartFired = false;\n\n  // cache mouse coordinates here\n  var mouseX;\n  var mouseY;\n\n  // Where the first click has happened, so that we can differentiate\n  // between pan and click\n  var clickX;\n  var clickY;\n\n  var pinchZoomLength;\n\n  var smoothScroll;\n  if ('smoothScroll' in options && !options.smoothScroll) {\n    // If user explicitly asked us not to use smooth scrolling, we obey\n    smoothScroll = rigidScroll();\n  } else {\n    // otherwise we use forward smoothScroll settings to kinetic API\n    // which makes scroll smoothing.\n    smoothScroll = kinetic(getPoint, scroll, options.smoothScroll);\n  }\n\n  var moveByAnimation;\n  var zoomToAnimation;\n\n  var multiTouch;\n  var paused = false;\n\n  listenForEvents();\n\n  var api = {\n    dispose: dispose,\n    moveBy: internalMoveBy,\n    moveTo: moveTo,\n    smoothMoveTo: smoothMoveTo, \n    centerOn: centerOn,\n    zoomTo: publicZoomTo,\n    zoomAbs: zoomAbs,\n    smoothZoom: smoothZoom,\n    smoothZoomAbs: smoothZoomAbs,\n    showRectangle: showRectangle,\n\n    pause: pause,\n    resume: resume,\n    isPaused: isPaused,\n\n    getTransform: getTransformModel,\n\n    getMinZoom: getMinZoom,\n    setMinZoom: setMinZoom,\n\n    getMaxZoom: getMaxZoom,\n    setMaxZoom: setMaxZoom,\n\n    getTransformOrigin: getTransformOrigin,\n    setTransformOrigin: setTransformOrigin,\n\n    getZoomSpeed: getZoomSpeed,\n    setZoomSpeed: setZoomSpeed\n  };\n\n  eventify(api);\n  \n  var initialX = typeof options.initialX === 'number' ? options.initialX : transform.x;\n  var initialY = typeof options.initialY === 'number' ? options.initialY : transform.y;\n  var initialZoom = typeof options.initialZoom === 'number' ? options.initialZoom : transform.scale;\n\n  if(initialX != transform.x || initialY != transform.y || initialZoom != transform.scale){\n    zoomAbs(initialX, initialY, initialZoom);\n  }\n\n  return api;\n\n  function pause() {\n    releaseEvents();\n    paused = true;\n  }\n\n  function resume() {\n    if (paused) {\n      listenForEvents();\n      paused = false;\n    }\n  }\n\n  function isPaused() {\n    return paused;\n  }\n\n  function showRectangle(rect) {\n    // TODO: this duplicates autocenter. I think autocenter should go.\n    var clientRect = owner.getBoundingClientRect();\n    var size = transformToScreen(clientRect.width, clientRect.height);\n\n    var rectWidth = rect.right - rect.left;\n    var rectHeight = rect.bottom - rect.top;\n    if (!Number.isFinite(rectWidth) || !Number.isFinite(rectHeight)) {\n      throw new Error('Invalid rectangle');\n    }\n\n    var dw = size.x / rectWidth;\n    var dh = size.y / rectHeight;\n    var scale = Math.min(dw, dh);\n    transform.x = -(rect.left + rectWidth / 2) * scale + size.x / 2;\n    transform.y = -(rect.top + rectHeight / 2) * scale + size.y / 2;\n    transform.scale = scale;\n  }\n\n  function transformToScreen(x, y) {\n    if (panController.getScreenCTM) {\n      var parentCTM = panController.getScreenCTM();\n      var parentScaleX = parentCTM.a;\n      var parentScaleY = parentCTM.d;\n      var parentOffsetX = parentCTM.e;\n      var parentOffsetY = parentCTM.f;\n      storedCTMResult.x = x * parentScaleX - parentOffsetX;\n      storedCTMResult.y = y * parentScaleY - parentOffsetY;\n    } else {\n      storedCTMResult.x = x;\n      storedCTMResult.y = y;\n    }\n\n    return storedCTMResult;\n  }\n\n  function autocenter() {\n    var w; // width of the parent\n    var h; // height of the parent\n    var left = 0;\n    var top = 0;\n    var sceneBoundingBox = getBoundingBox();\n    if (sceneBoundingBox) {\n      // If we have bounding box - use it.\n      left = sceneBoundingBox.left;\n      top = sceneBoundingBox.top;\n      w = sceneBoundingBox.right - sceneBoundingBox.left;\n      h = sceneBoundingBox.bottom - sceneBoundingBox.top;\n    } else {\n      // otherwise just use whatever space we have\n      var ownerRect = owner.getBoundingClientRect();\n      w = ownerRect.width;\n      h = ownerRect.height;\n    }\n    var bbox = panController.getBBox();\n    if (bbox.width === 0 || bbox.height === 0) {\n      // we probably do not have any elements in the SVG\n      // just bail out;\n      return;\n    }\n    var dh = h / bbox.height;\n    var dw = w / bbox.width;\n    var scale = Math.min(dw, dh);\n    transform.x = -(bbox.left + bbox.width / 2) * scale + w / 2 + left;\n    transform.y = -(bbox.top + bbox.height / 2) * scale + h / 2 + top;\n    transform.scale = scale;\n  }\n\n  function getTransformModel() {\n    // TODO: should this be read only?\n    return transform;\n  }\n\n  function getMinZoom() {\n    return minZoom;\n  }\n\n  function setMinZoom(newMinZoom) {\n    minZoom = newMinZoom;\n  }\n\n  function getMaxZoom() {\n    return maxZoom;\n  }\n\n  function setMaxZoom(newMaxZoom) {\n    maxZoom = newMaxZoom;\n  }\n\n  function getTransformOrigin() {\n    return transformOrigin;\n  }\n\n  function setTransformOrigin(newTransformOrigin) {\n    transformOrigin = parseTransformOrigin(newTransformOrigin);\n  }\n\n  function getZoomSpeed() {\n    return speed;\n  }\n\n  function setZoomSpeed(newSpeed) {\n    if (!Number.isFinite(newSpeed)) {\n      throw new Error('Zoom speed should be a number');\n    }\n    speed = newSpeed;\n  }\n\n  function getPoint() {\n    return {\n      x: transform.x,\n      y: transform.y\n    };\n  }\n\n  function moveTo(x, y) {\n    transform.x = x;\n    transform.y = y;\n\n    keepTransformInsideBounds();\n\n    triggerEvent('pan');\n    makeDirty();\n  }\n\n  function moveBy(dx, dy) {\n    moveTo(transform.x + dx, transform.y + dy);\n  }\n\n  function keepTransformInsideBounds() {\n    var boundingBox = getBoundingBox();\n    if (!boundingBox) return;\n\n    var adjusted = false;\n    var clientRect = getClientRect();\n\n    var diff = boundingBox.left - clientRect.right;\n    if (diff > 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n    // check the other side:\n    diff = boundingBox.right - clientRect.left;\n    if (diff < 0) {\n      transform.x += diff;\n      adjusted = true;\n    }\n\n    // y axis:\n    diff = boundingBox.top - clientRect.bottom;\n    if (diff > 0) {\n      // we adjust transform, so that it matches exactly our bounding box:\n      // transform.y = boundingBox.top - (boundingBox.height + boundingBox.y) * transform.scale =>\n      // transform.y = boundingBox.top - (clientRect.bottom - transform.y) =>\n      // transform.y = diff + transform.y =>\n      transform.y += diff;\n      adjusted = true;\n    }\n\n    diff = boundingBox.bottom - clientRect.top;\n    if (diff < 0) {\n      transform.y += diff;\n      adjusted = true;\n    }\n    return adjusted;\n  }\n\n  /**\n   * Returns bounding box that should be used to restrict scene movement.\n   */\n  function getBoundingBox() {\n    if (!bounds) return; // client does not want to restrict movement\n\n    if (typeof bounds === 'boolean') {\n      // for boolean type we use parent container bounds\n      var ownerRect = owner.getBoundingClientRect();\n      var sceneWidth = ownerRect.width;\n      var sceneHeight = ownerRect.height;\n\n      return {\n        left: sceneWidth * boundsPadding,\n        top: sceneHeight * boundsPadding,\n        right: sceneWidth * (1 - boundsPadding),\n        bottom: sceneHeight * (1 - boundsPadding)\n      };\n    }\n\n    return bounds;\n  }\n\n  function getClientRect() {\n    var bbox = panController.getBBox();\n    var leftTop = client(bbox.left, bbox.top);\n\n    return {\n      left: leftTop.x,\n      top: leftTop.y,\n      right: bbox.width * transform.scale + leftTop.x,\n      bottom: bbox.height * transform.scale + leftTop.y\n    };\n  }\n\n  function client(x, y) {\n    return {\n      x: x * transform.scale + transform.x,\n      y: y * transform.scale + transform.y\n    };\n  }\n\n  function makeDirty() {\n    isDirty = true;\n    frameAnimation = window.requestAnimationFrame(frame);\n  }\n\n  function zoomByRatio(clientX, clientY, ratio) {\n    if (isNaN(clientX) || isNaN(clientY) || isNaN(ratio)) {\n      throw new Error('zoom requires valid numbers');\n    }\n\n    var newScale = transform.scale * ratio;\n\n    if (newScale < minZoom) {\n      if (transform.scale === minZoom) return;\n\n      ratio = minZoom / transform.scale;\n    }\n    if (newScale > maxZoom) {\n      if (transform.scale === maxZoom) return;\n\n      ratio = maxZoom / transform.scale;\n    }\n\n    var size = transformToScreen(clientX, clientY);\n\n    transform.x = size.x - ratio * (size.x - transform.x);\n    transform.y = size.y - ratio * (size.y - transform.y);\n\n    // TODO: https://github.com/anvaka/panzoom/issues/112\n    if (bounds && boundsPadding === 1 && minZoom === 1) {\n      transform.scale *= ratio;\n      keepTransformInsideBounds();\n    } else {\n      var transformAdjusted = keepTransformInsideBounds();\n      if (!transformAdjusted) transform.scale *= ratio;\n    }\n\n    triggerEvent('zoom');\n\n    makeDirty();\n  }\n\n  function zoomAbs(clientX, clientY, zoomLevel) {\n    var ratio = zoomLevel / transform.scale;\n    zoomByRatio(clientX, clientY, ratio);\n  }\n\n  function centerOn(ui) {\n    var parent = ui.ownerSVGElement;\n    if (!parent)\n      throw new Error('ui element is required to be within the scene');\n\n    // TODO: should i use controller's screen CTM?\n    var clientRect = ui.getBoundingClientRect();\n    var cx = clientRect.left + clientRect.width / 2;\n    var cy = clientRect.top + clientRect.height / 2;\n\n    var container = parent.getBoundingClientRect();\n    var dx = container.width / 2 - cx;\n    var dy = container.height / 2 - cy;\n\n    internalMoveBy(dx, dy, true);\n  }\n\n  function smoothMoveTo(x, y){\n    internalMoveBy(x - transform.x, y - transform.y, true);\n  }\n\n  function internalMoveBy(dx, dy, smooth) {\n    if (!smooth) {\n      return moveBy(dx, dy);\n    }\n\n    if (moveByAnimation) moveByAnimation.cancel();\n\n    var from = { x: 0, y: 0 };\n    var to = { x: dx, y: dy };\n    var lastX = 0;\n    var lastY = 0;\n\n    moveByAnimation = animate(from, to, {\n      step: function (v) {\n        moveBy(v.x - lastX, v.y - lastY);\n\n        lastX = v.x;\n        lastY = v.y;\n      }\n    });\n  }\n\n  function scroll(x, y) {\n    cancelZoomAnimation();\n    moveTo(x, y);\n  }\n\n  function dispose() {\n    releaseEvents();\n  }\n\n  function listenForEvents() {\n    owner.addEventListener('mousedown', onMouseDown, { passive: false });\n    owner.addEventListener('dblclick', onDoubleClick, { passive: false });\n    owner.addEventListener('touchstart', onTouch, { passive: false });\n    owner.addEventListener('keydown', onKeyDown, { passive: false });\n\n    // Need to listen on the owner container, so that we are not limited\n    // by the size of the scrollable domElement\n    wheel.addWheelListener(owner, onMouseWheel, { passive: false });\n\n    makeDirty();\n  }\n\n  function releaseEvents() {\n    wheel.removeWheelListener(owner, onMouseWheel);\n    owner.removeEventListener('mousedown', onMouseDown);\n    owner.removeEventListener('keydown', onKeyDown);\n    owner.removeEventListener('dblclick', onDoubleClick);\n    owner.removeEventListener('touchstart', onTouch);\n\n    if (frameAnimation) {\n      window.cancelAnimationFrame(frameAnimation);\n      frameAnimation = 0;\n    }\n\n    smoothScroll.cancel();\n\n    releaseDocumentMouse();\n    releaseTouches();\n    textSelection.release();\n\n    triggerPanEnd();\n  }\n\n  function frame() {\n    if (isDirty) applyTransform();\n  }\n\n  function applyTransform() {\n    isDirty = false;\n\n    // TODO: Should I allow to cancel this?\n    panController.applyTransform(transform);\n\n    triggerEvent('transform');\n    frameAnimation = 0;\n  }\n\n  function onKeyDown(e) {\n    var x = 0,\n      y = 0,\n      z = 0;\n    if (e.keyCode === 38) {\n      y = 1; // up\n    } else if (e.keyCode === 40) {\n      y = -1; // down\n    } else if (e.keyCode === 37) {\n      x = 1; // left\n    } else if (e.keyCode === 39) {\n      x = -1; // right\n    } else if (e.keyCode === 189 || e.keyCode === 109) {\n      // DASH or SUBTRACT\n      z = 1; // `-` -  zoom out\n    } else if (e.keyCode === 187 || e.keyCode === 107) {\n      // EQUAL SIGN or ADD\n      z = -1; // `=` - zoom in (equal sign on US layout is under `+`)\n    }\n\n    if (filterKey(e, x, y, z)) {\n      // They don't want us to handle the key: https://github.com/anvaka/panzoom/issues/45\n      return;\n    }\n\n    if (x || y) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      var clientRect = owner.getBoundingClientRect();\n      // movement speed should be the same in both X and Y direction:\n      var offset = Math.min(clientRect.width, clientRect.height);\n      var moveSpeedRatio = 0.05;\n      var dx = offset * moveSpeedRatio * x;\n      var dy = offset * moveSpeedRatio * y;\n\n      // TODO: currently we do not animate this. It could be better to have animation\n      internalMoveBy(dx, dy);\n    }\n\n    if (z) {\n      var scaleMultiplier = getScaleMultiplier(z * 100);\n      var offset = transformOrigin ? getTransformOriginOffset() : midPoint();\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n    }\n  }\n\n  function midPoint() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width / 2,\n      y: ownerRect.height / 2\n    };\n  }\n\n  function onTouch(e) {\n    // let them override the touch behavior\n    beforeTouch(e);\n    clearPendingClickEventTimeout();\n\n    if (e.touches.length === 1) {\n      return handleSingleFingerTouch(e, e.touches[0]);\n    } else if (e.touches.length === 2) {\n      // handleTouchMove() will care about pinch zoom.\n      pinchZoomLength = getPinchZoomLength(e.touches[0], e.touches[1]);\n      multiTouch = true;\n      startTouchListenerIfNeeded();\n    }\n  }\n\n  function beforeTouch(e) {\n    // TODO: Need to unify this filtering names. E.g. use `beforeTouch`\n    if (options.onTouch && !options.onTouch(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/12\n      return;\n    }\n\n    e.stopPropagation();\n    e.preventDefault();\n  }\n\n  function beforeDoubleClick(e) {\n    clearPendingClickEventTimeout();\n\n    // TODO: Need to unify this filtering names. E.g. use `beforeDoubleClick``\n    if (options.onDoubleClick && !options.onDoubleClick(e)) {\n      // if they return `false` from onTouch, we don't want to stop\n      // events propagation. Fixes https://github.com/anvaka/panzoom/issues/46\n      return;\n    }\n\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  function handleSingleFingerTouch(e) {\n    lastTouchStartTime = new Date();\n    var touch = e.touches[0];\n    var offset = getOffsetXY(touch);\n    lastSingleFingerOffset = offset;\n    var point = transformToScreen(offset.x, offset.y);\n    mouseX = point.x;\n    mouseY = point.y;\n    clickX = mouseX;\n    clickY = mouseY;\n\n    smoothScroll.cancel();\n    startTouchListenerIfNeeded();\n  }\n\n  function startTouchListenerIfNeeded() {\n    if (touchInProgress) {\n      // no need to do anything, as we already listen to events;\n      return;\n    }\n\n    touchInProgress = true;\n    document.addEventListener('touchmove', handleTouchMove);\n    document.addEventListener('touchend', handleTouchEnd);\n    document.addEventListener('touchcancel', handleTouchEnd);\n  }\n\n  function handleTouchMove(e) {\n    if (e.touches.length === 1) {\n      e.stopPropagation();\n      var touch = e.touches[0];\n\n      var offset = getOffsetXY(touch);\n      var point = transformToScreen(offset.x, offset.y);\n\n      var dx = point.x - mouseX;\n      var dy = point.y - mouseY;\n\n      if (dx !== 0 && dy !== 0) {\n        triggerPanStart();\n      }\n      mouseX = point.x;\n      mouseY = point.y;\n      internalMoveBy(dx, dy);\n    } else if (e.touches.length === 2) {\n      // it's a zoom, let's find direction\n      multiTouch = true;\n      var t1 = e.touches[0];\n      var t2 = e.touches[1];\n      var currentPinchLength = getPinchZoomLength(t1, t2);\n\n      // since the zoom speed is always based on distance from 1, we need to apply\n      // pinch speed only on that distance from 1:\n      var scaleMultiplier =\n        1 + (currentPinchLength / pinchZoomLength - 1) * pinchSpeed;\n\n      var firstTouchPoint = getOffsetXY(t1);\n      var secondTouchPoint = getOffsetXY(t2);\n      mouseX = (firstTouchPoint.x + secondTouchPoint.x) / 2;\n      mouseY = (firstTouchPoint.y + secondTouchPoint.y) / 2;\n      if (transformOrigin) {\n        var offset = getTransformOriginOffset();\n        mouseX = offset.x;\n        mouseY = offset.y;\n      }\n\n      publicZoomTo(mouseX, mouseY, scaleMultiplier);\n\n      pinchZoomLength = currentPinchLength;\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  }\n\n  function clearPendingClickEventTimeout() {\n    if (pendingClickEventTimeout) {\n      clearTimeout(pendingClickEventTimeout);\n      pendingClickEventTimeout = 0;\n    }\n  }\n\n  function handlePotentialClickEvent(e) {\n    // we could still be in the double tap mode, let's wait until double tap expires,\n    // and then notify:\n    if (!options.onClick) return;\n    clearPendingClickEventTimeout();\n    var dx = mouseX - clickX;\n    var dy = mouseY - clickY;\n    var l = Math.sqrt(dx * dx + dy * dy);\n    if (l > 5) return; // probably they are panning, ignore it\n\n    pendingClickEventTimeout = setTimeout(function() {\n      pendingClickEventTimeout = 0;\n      options.onClick(e);\n    }, doubleTapSpeedInMS);\n  }\n\n  function handleTouchEnd(e) {\n    clearPendingClickEventTimeout();\n    if (e.touches.length > 0) {\n      var offset = getOffsetXY(e.touches[0]);\n      var point = transformToScreen(offset.x, offset.y);\n      mouseX = point.x;\n      mouseY = point.y;\n    } else {\n      var now = new Date();\n      if (now - lastTouchEndTime < doubleTapSpeedInMS) {\n        // They did a double tap here\n        if (transformOrigin) {\n          var offset = getTransformOriginOffset();\n          smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n        } else {\n          // We want untransformed x/y here.\n          smoothZoom(lastSingleFingerOffset.x, lastSingleFingerOffset.y, zoomDoubleClickSpeed);\n        }\n      } else if (now - lastTouchStartTime < clickEventTimeInMS) {\n        handlePotentialClickEvent(e);\n      }\n\n      lastTouchEndTime = now;\n\n      triggerPanEnd();\n      releaseTouches();\n    }\n  }\n\n  function getPinchZoomLength(finger1, finger2) {\n    var dx = finger1.clientX - finger2.clientX;\n    var dy = finger1.clientY - finger2.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  }\n\n  function onDoubleClick(e) {\n    beforeDoubleClick(e);\n    var offset = getOffsetXY(e);\n    if (transformOrigin) {\n      // TODO: looks like this is duplicated in the file.\n      // Need to refactor\n      offset = getTransformOriginOffset();\n    }\n    smoothZoom(offset.x, offset.y, zoomDoubleClickSpeed);\n  }\n\n  function onMouseDown(e) {\n    clearPendingClickEventTimeout();\n\n    // if client does not want to handle this event - just ignore the call\n    if (beforeMouseDown(e)) return;\n\n    lastMouseDownedEvent = e;\n    lastMouseDownTime = new Date();\n\n    if (touchInProgress) {\n      // modern browsers will fire mousedown for touch events too\n      // we do not want this: touch is handled separately.\n      e.stopPropagation();\n      return false;\n    }\n    // for IE, left click == 1\n    // for Firefox, left click == 0\n    var isLeftButton =\n      (e.button === 1 && window.event !== null) || e.button === 0;\n    if (!isLeftButton) return;\n\n    smoothScroll.cancel();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    clickX = mouseX = point.x;\n    clickY = mouseY = point.y;\n\n    // We need to listen on document itself, since mouse can go outside of the\n    // window, and we will loose it\n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    textSelection.capture(e.target || e.srcElement);\n\n    return false;\n  }\n\n  function onMouseMove(e) {\n    // no need to worry about mouse events when touch is happening\n    if (touchInProgress) return;\n\n    triggerPanStart();\n\n    var offset = getOffsetXY(e);\n    var point = transformToScreen(offset.x, offset.y);\n    var dx = point.x - mouseX;\n    var dy = point.y - mouseY;\n\n    mouseX = point.x;\n    mouseY = point.y;\n\n    internalMoveBy(dx, dy);\n  }\n\n  function onMouseUp() {\n    var now = new Date();\n    if (now - lastMouseDownTime < clickEventTimeInMS) handlePotentialClickEvent(lastMouseDownedEvent);\n    textSelection.release();\n    triggerPanEnd();\n    releaseDocumentMouse();\n  }\n\n  function releaseDocumentMouse() {\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    panstartFired = false;\n  }\n\n  function releaseTouches() {\n    document.removeEventListener('touchmove', handleTouchMove);\n    document.removeEventListener('touchend', handleTouchEnd);\n    document.removeEventListener('touchcancel', handleTouchEnd);\n    panstartFired = false;\n    multiTouch = false;\n    touchInProgress = false;\n  }\n\n  function onMouseWheel(e) {\n    // if client does not want to handle this event - just ignore the call\n    if (beforeWheel(e)) return;\n\n    smoothScroll.cancel();\n\n    var delta = e.deltaY;\n    if (e.deltaMode > 0) delta *= 100;\n\n    var scaleMultiplier = getScaleMultiplier(delta);\n\n    if (scaleMultiplier !== 1) {\n      var offset = transformOrigin\n        ? getTransformOriginOffset()\n        : getOffsetXY(e);\n      publicZoomTo(offset.x, offset.y, scaleMultiplier);\n      e.preventDefault();\n    }\n  }\n\n  function getOffsetXY(e) {\n    var offsetX, offsetY;\n    // I tried using e.offsetX, but that gives wrong results for svg, when user clicks on a path.\n    var ownerRect = owner.getBoundingClientRect();\n    offsetX = e.clientX - ownerRect.left;\n    offsetY = e.clientY - ownerRect.top;\n\n    return { x: offsetX, y: offsetY };\n  }\n\n  function smoothZoom(clientX, clientY, scaleMultiplier) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: scaleMultiplier * fromValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      },\n      done: triggerZoomEnd\n    });\n  }\n\n  function smoothZoomAbs(clientX, clientY, toScaleValue) {\n    var fromValue = transform.scale;\n    var from = { scale: fromValue };\n    var to = { scale: toScaleValue };\n\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n\n    zoomToAnimation = animate(from, to, {\n      step: function (v) {\n        zoomAbs(clientX, clientY, v.scale);\n      }\n    });\n  }\n\n  function getTransformOriginOffset() {\n    var ownerRect = owner.getBoundingClientRect();\n    return {\n      x: ownerRect.width * transformOrigin.x,\n      y: ownerRect.height * transformOrigin.y\n    };\n  }\n\n  function publicZoomTo(clientX, clientY, scaleMultiplier) {\n    smoothScroll.cancel();\n    cancelZoomAnimation();\n    return zoomByRatio(clientX, clientY, scaleMultiplier);\n  }\n\n  function cancelZoomAnimation() {\n    if (zoomToAnimation) {\n      zoomToAnimation.cancel();\n      zoomToAnimation = null;\n    }\n  }\n\n  function getScaleMultiplier(delta) {\n    var sign = Math.sign(delta);\n    var deltaAdjustedSpeed = Math.min(0.25, Math.abs(speed * delta / 128));\n    return 1 - sign * deltaAdjustedSpeed;\n  }\n\n  function triggerPanStart() {\n    if (!panstartFired) {\n      triggerEvent('panstart');\n      panstartFired = true;\n      smoothScroll.start();\n    }\n  }\n\n  function triggerPanEnd() {\n    if (panstartFired) {\n      // we should never run smooth scrolling if it was multiTouch (pinch zoom animation):\n      if (!multiTouch) smoothScroll.stop();\n      triggerEvent('panend');\n    }\n  }\n\n  function triggerZoomEnd() {\n    triggerEvent('zoomend');\n  }\n\n  function triggerEvent(name) {\n    api.fire(name, api);\n  }\n}\n\nfunction parseTransformOrigin(options) {\n  if (!options) return;\n  if (typeof options === 'object') {\n    if (!isNumber(options.x) || !isNumber(options.y))\n      failTransformOrigin(options);\n    return options;\n  }\n\n  failTransformOrigin();\n}\n\nfunction failTransformOrigin(options) {\n  console.error(options);\n  throw new Error(\n    [\n      'Cannot parse transform origin.',\n      'Some good examples:',\n      '  \"center center\" can be achieved with {x: 0.5, y: 0.5}',\n      '  \"top center\" can be achieved with {x: 0.5, y: 0}',\n      '  \"bottom right\" can be achieved with {x: 1, y: 1}'\n    ].join('\\n')\n  );\n}\n\nfunction noop() { }\n\nfunction validateBounds(bounds) {\n  var boundsType = typeof bounds;\n  if (boundsType === 'undefined' || boundsType === 'boolean') return; // this is okay\n  // otherwise need to be more thorough:\n  var validBounds =\n    isNumber(bounds.left) &&\n    isNumber(bounds.top) &&\n    isNumber(bounds.bottom) &&\n    isNumber(bounds.right);\n\n  if (!validBounds)\n    throw new Error(\n      'Bounds object is not valid. It can be: ' +\n      'undefined, boolean (true|false) or an object {left, top, right, bottom}'\n    );\n}\n\nfunction isNumber(x) {\n  return Number.isFinite(x);\n}\n\n// IE 11 does not support isNaN:\nfunction isNaN(value) {\n  if (Number.isNaN) {\n    return Number.isNaN(value);\n  }\n\n  return value !== value;\n}\n\nfunction rigidScroll() {\n  return {\n    start: noop,\n    stop: noop,\n    cancel: noop\n  };\n}\n\nfunction autoRun() {\n  if (typeof document === 'undefined') return;\n\n  var scripts = document.getElementsByTagName('script');\n  if (!scripts) return;\n  var panzoomScript;\n\n  for (var i = 0; i < scripts.length; ++i) {\n    var x = scripts[i];\n    if (x.src && x.src.match(/\\bpanzoom(\\.min)?\\.js/)) {\n      panzoomScript = x;\n      break;\n    }\n  }\n\n  if (!panzoomScript) return;\n\n  var query = panzoomScript.getAttribute('query');\n  if (!query) return;\n\n  var globalName = panzoomScript.getAttribute('name') || 'pz';\n  var started = Date.now();\n\n  tryAttach();\n\n  function tryAttach() {\n    var el = document.querySelector(query);\n    if (!el) {\n      var now = Date.now();\n      var elapsed = now - started;\n      if (elapsed < 2000) {\n        // Let's wait a bit\n        setTimeout(tryAttach, 100);\n        return;\n      }\n      // If we don't attach within 2 seconds to the target element, consider it a failure\n      console.error('Cannot find the panzoom element', globalName);\n      return;\n    }\n    var options = collectOptions(panzoomScript);\n    console.log(options);\n    window[globalName] = createPanZoom(el, options);\n  }\n\n  function collectOptions(script) {\n    var attrs = script.attributes;\n    var options = {};\n    for (var j = 0; j < attrs.length; ++j) {\n      var attr = attrs[j];\n      var nameValue = getPanzoomAttributeNameValue(attr);\n      if (nameValue) {\n        options[nameValue.name] = nameValue.value;\n      }\n    }\n\n    return options;\n  }\n\n  function getPanzoomAttributeNameValue(attr) {\n    if (!attr.name) return;\n    var isPanZoomAttribute =\n      attr.name[0] === 'p' && attr.name[1] === 'z' && attr.name[2] === '-';\n\n    if (!isPanZoomAttribute) return;\n\n    var name = attr.name.substr(3);\n    var value = JSON.parse(attr.value);\n    return { name: name, value: value };\n  }\n}\n\nautoRun();\n\t","<script lang=\"ts\">\n\timport { onDestroy, onMount } from 'svelte';\n\timport panzoom, { type PanZoom } from 'panzoom';\n\n\timport fileSaver from 'file-saver';\n\tconst { saveAs } = fileSaver;\n\n\texport let show = false;\n\texport let src = '';\n\texport let alt = '';\n\n\tlet mounted = false;\n\n\tlet previewElement = null;\n\n\tlet instance: PanZoom;\n\n\tlet sceneParentElement: HTMLElement;\n\tlet sceneElement: HTMLElement;\n\n\t$: if (sceneElement) {\n\t\tinstance = panzoom(sceneElement, {\n\t\t\tbounds: true,\n\t\t\tboundsPadding: 0.1,\n\n\t\t\tzoomSpeed: 0.065\n\t\t});\n\t}\n\tconst resetPanZoomViewport = () => {\n\t\tinstance.moveTo(0, 0);\n\t\tinstance.zoomAbs(0, 0, 1);\n\t\tconsole.log(instance.getTransform());\n\t};\n\n\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\tif (event.key === 'Escape') {\n\t\t\tconsole.log('Escape');\n\t\t\tshow = false;\n\t\t}\n\t};\n\n\tonMount(() => {\n\t\tmounted = true;\n\t});\n\n\t$: if (show && previewElement) {\n\t\tdocument.body.appendChild(previewElement);\n\t\twindow.addEventListener('keydown', handleKeyDown);\n\t\tdocument.body.style.overflow = 'hidden';\n\t} else if (previewElement) {\n\t\twindow.removeEventListener('keydown', handleKeyDown);\n\t\tdocument.body.removeChild(previewElement);\n\t\tdocument.body.style.overflow = 'unset';\n\t}\n\n\tonDestroy(() => {\n\t\tshow = false;\n\n\t\tif (previewElement) {\n\t\t\tdocument.body.removeChild(previewElement);\n\t\t}\n\t});\n</script>\n\n{#if show}\n\t<!-- svelte-ignore a11y-click-events-have-key-events -->\n\t<!-- svelte-ignore a11y-no-static-element-interactions -->\n\t<div\n\t\tbind:this={previewElement}\n\t\tclass=\"modal fixed top-0 right-0 left-0 bottom-0 bg-black text-white w-full min-h-screen h-screen flex justify-center z-9999 overflow-hidden overscroll-contain\"\n\t>\n\t\t<div class=\" absolute left-0 w-full flex justify-between select-none z-20\">\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" p-5\"\n\t\t\t\t\ton:pointerdown={(e) => {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\tshow = false;\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tclass=\"w-6 h-6\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<button\n\t\t\t\t\tclass=\" p-5 z-999\"\n\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\tif (src.startsWith('data:image/')) {\n\t\t\t\t\t\t\tconst base64Data = src.split(',')[1];\n\t\t\t\t\t\t\tconst blob = new Blob([Uint8Array.from(atob(base64Data), (c) => c.charCodeAt(0))], {\n\t\t\t\t\t\t\t\ttype: 'image/png'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tconst mimeType = blob.type || 'image/png';\n\t\t\t\t\t\t\t// create file name based on the MIME type, alt should be a valid file name with extension\n\t\t\t\t\t\t\tconst fileName = alt\n\t\t\t\t\t\t\t\t? `${alt.replaceAll('.', '')}.${mimeType.split('/')[1]}`\n\t\t\t\t\t\t\t\t: 'download.png';\n\n\t\t\t\t\t\t\t// Use FileSaver to save the blob\n\t\t\t\t\t\t\tsaveAs(blob, fileName);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if (src.startsWith('blob:')) {\n\t\t\t\t\t\t\t// Handle blob URLs\n\t\t\t\t\t\t\tfetch(src)\n\t\t\t\t\t\t\t\t.then((response) => response.blob())\n\t\t\t\t\t\t\t\t.then((blob) => {\n\t\t\t\t\t\t\t\t\t// detect the MIME type from the blob\n\t\t\t\t\t\t\t\t\tconst mimeType = blob.type || 'image/png';\n\n\t\t\t\t\t\t\t\t\t// Create a new Blob with the correct MIME type\n\t\t\t\t\t\t\t\t\tconst blobWithType = new Blob([blob], { type: mimeType });\n\n\t\t\t\t\t\t\t\t\t// create file name based on the MIME type, alt should be a valid file name with extension\n\t\t\t\t\t\t\t\t\tconst fileName = alt\n\t\t\t\t\t\t\t\t\t\t? `${alt.replaceAll('.', '')}.${mimeType.split('/')[1]}`\n\t\t\t\t\t\t\t\t\t\t: 'download.png';\n\n\t\t\t\t\t\t\t\t\t// Use FileSaver to save the blob\n\t\t\t\t\t\t\t\t\tsaveAs(blobWithType, fileName);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\t\tconsole.error('Error downloading blob:', error);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\tsrc.startsWith('/') ||\n\t\t\t\t\t\t\tsrc.startsWith('http://') ||\n\t\t\t\t\t\t\tsrc.startsWith('https://')\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// Handle remote URLs\n\t\t\t\t\t\t\tfetch(src)\n\t\t\t\t\t\t\t\t.then((response) => response.blob())\n\t\t\t\t\t\t\t\t.then((blob) => {\n\t\t\t\t\t\t\t\t\t// detect the MIME type from the blob\n\t\t\t\t\t\t\t\t\tconst mimeType = blob.type || 'image/png';\n\n\t\t\t\t\t\t\t\t\t// Create a new Blob with the correct MIME type\n\t\t\t\t\t\t\t\t\tconst blobWithType = new Blob([blob], { type: mimeType });\n\n\t\t\t\t\t\t\t\t\t// create file name based on the MIME type, alt should be a valid file name with extension\n\t\t\t\t\t\t\t\t\tconst fileName = alt\n\t\t\t\t\t\t\t\t\t\t? `${alt.replaceAll('.', '')}.${mimeType.split('/')[1]}`\n\t\t\t\t\t\t\t\t\t\t: 'download.png';\n\n\t\t\t\t\t\t\t\t\t// Use FileSaver to save the blob\n\t\t\t\t\t\t\t\t\tsaveAs(blobWithType, fileName);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\t\t\tconsole.error('Error downloading remote image:', error);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<svg\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t\tclass=\"w-6 h-6\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M10.75 2.75a.75.75 0 0 0-1.5 0v8.614L6.295 8.235a.75.75 0 1 0-1.09 1.03l4.25 4.5a.75.75 0 0 0 1.09 0l4.25-4.5a.75.75 0 0 0-1.09-1.03l-2.955 3.129V2.75Z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M3.5 12.75a.75.75 0 0 0-1.5 0v2.5A2.75 2.75 0 0 0 4.75 18h10.5A2.75 2.75 0 0 0 18 15.25v-2.5a.75.75 0 0 0-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5Z\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"flex h-full max-h-full justify-center items-center z-0\">\n\t\t\t<img\n\t\t\t\tbind:this={sceneElement}\n\t\t\t\t{src}\n\t\t\t\t{alt}\n\t\t\t\tclass=\" mx-auto h-full object-scale-down select-none\"\n\t\t\t\tdraggable=\"false\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { WEBUI_BASE_URL } from '$lib/constants';\n\timport ImagePreview from './ImagePreview.svelte';\n\n\texport let src = '';\n\texport let alt = '';\n\n\texport let className = ' w-full outline-hidden focus:outline-hidden';\n\texport let imageClassName = 'rounded-lg';\n\n\texport let dismissible = false;\n\texport let onDismiss = () => {};\n\n\tlet _src = '';\n\t$: _src = src.startsWith('/') ? `${WEBUI_BASE_URL}${src}` : src;\n\n\tlet showImagePreview = false;\n</script>\n\n<ImagePreview bind:show={showImagePreview} src={_src} {alt} />\n\n<div class=\" relative group w-fit\">\n\t<button\n\t\tclass={className}\n\t\ton:click={() => {\n\t\t\tshowImagePreview = true;\n\t\t}}\n\t\ttype=\"button\"\n\t>\n\t\t<img src={_src} {alt} class={imageClassName} draggable=\"false\" data-cy=\"image\" />\n\t</button>\n\n\t{#if dismissible}\n\t\t<div class=\" absolute -top-1 -right-1\">\n\t\t\t<button\n\t\t\t\tclass=\" bg-white text-black border border-white rounded-full group-hover:visible invisible transition\"\n\t\t\t\ttype=\"button\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tonDismiss();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\tviewBox=\"0 0 20 20\"\n\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\tclass=\"size-4\"\n\t\t\t\t>\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t</button>\n\t\t</div>\n\t{/if}\n</div>\n"],"names":["wheelModule","addWheelListener","removeWheelListener","element","listener","useCapture","NEWTON_ITERATIONS","NEWTON_MIN_SLOPE","SUBDIVISION_PRECISION","SUBDIVISION_MAX_ITERATIONS","kSplineTableSize","kSampleStepSize","float32ArraySupported","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","i","newtonRaphsonIterate","aGuessT","currentSlope","LinearEasing","x","src","mY1","mY2","sampleValues","getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","BezierEasing","require$$0","animations","amatorModule","animate","makeAggregateRaf","source","target","options","start","diff","easing","step","noop","done","scheduler","getScheduler","keys","key","durationInMs","durationInFrames","previousAnimationId","frame","loop","cancel","t","setValues","canRaf","rafScheduler","timeoutScheduler","cb","id","frontBuffer","backBuffer","frameToken","next","clearAll","callback","renderNextFrame","renderFrame","ngraph_events","subject","validateSubject","eventsStorage","createEventsStorage","registeredEvents","eventName","ctx","handlers","wantToRemoveAll","deleteAllCallbacksForEvent","callbacks","fireArguments","callbackInfo","reservedWords","kinetic_1","kinetic","getPoint","scroll","settings","minVelocity","amplitude","cancelAnimationFrame","getCancelAnimationFrame","requestAnimationFrame","getRequestAnimationFrame","lastPoint","timestamp","timeConstant","ticker","vx","targetX","ax","vy","targetY","ay","raf","stop","dispose","track","now","elapsed","currentPoint","dx","dy","dt","autoScroll","moving","handler","createTextSelectionInterceptor_1","createTextSelectionInterceptor","useFake","dragObject","prevSelectStart","prevDragStart","wasCaptured","capture","release","domObject","disabled","e","transform","Transform","svgControllerModule","makeSvgController","isSVGElement","svgElement","owner","api","getBBox","getScreenCTM","getOwner","applyTransform","initTransform","bbox","ctm","screenCTM","domControllerModule","makeDomController","isDomElement","domElement","elementValid","wheel","require$$1","eventify","require$$2","require$$3","require$$4","domTextSelectionInterceptor","fakeTextSelectorInterceptor","require$$5","require$$6","require$$7","defaultZoomSpeed","defaultDoubleTapZoomSpeed","doubleTapSpeedInMS","clickEventTimeInMS","panzoom","createPanZoom","panController","storedCTMResult","isDirty","filterKey","pinchSpeed","bounds","maxZoom","minZoom","boundsPadding","zoomDoubleClickSpeed","beforeWheel","beforeMouseDown","speed","transformOrigin","parseTransformOrigin","textSelection","validateBounds","autocenter","frameAnimation","lastTouchEndTime","lastTouchStartTime","pendingClickEventTimeout","lastMouseDownedEvent","lastMouseDownTime","lastSingleFingerOffset","touchInProgress","panstartFired","mouseX","mouseY","clickX","clickY","pinchZoomLength","smoothScroll","rigidScroll","moveByAnimation","zoomToAnimation","multiTouch","paused","listenForEvents","internalMoveBy","moveTo","smoothMoveTo","centerOn","publicZoomTo","zoomAbs","smoothZoom","smoothZoomAbs","showRectangle","pause","resume","isPaused","getTransformModel","getMinZoom","setMinZoom","getMaxZoom","setMaxZoom","getTransformOrigin","setTransformOrigin","getZoomSpeed","setZoomSpeed","initialX","initialY","initialZoom","releaseEvents","rect","clientRect","size","transformToScreen","rectWidth","rectHeight","dw","dh","scale","y","parentCTM","parentScaleX","parentScaleY","parentOffsetX","parentOffsetY","w","h","left","top","sceneBoundingBox","getBoundingBox","ownerRect","newMinZoom","newMaxZoom","newTransformOrigin","newSpeed","keepTransformInsideBounds","triggerEvent","makeDirty","moveBy","boundingBox","adjusted","getClientRect","sceneWidth","sceneHeight","leftTop","client","zoomByRatio","clientX","clientY","ratio","isNaN","newScale","transformAdjusted","zoomLevel","ui","parent","cx","cy","container","smooth","from","to","lastX","lastY","v","cancelZoomAnimation","onMouseDown","onDoubleClick","onTouch","onKeyDown","onMouseWheel","releaseDocumentMouse","releaseTouches","triggerPanEnd","z","offset","moveSpeedRatio","scaleMultiplier","getScaleMultiplier","getTransformOriginOffset","midPoint","beforeTouch","clearPendingClickEventTimeout","handleSingleFingerTouch","getPinchZoomLength","startTouchListenerIfNeeded","beforeDoubleClick","touch","getOffsetXY","point","handleTouchMove","handleTouchEnd","triggerPanStart","t1","t2","currentPinchLength","firstTouchPoint","secondTouchPoint","handlePotentialClickEvent","l","finger1","finger2","isLeftButton","onMouseMove","onMouseUp","delta","offsetX","offsetY","fromValue","triggerZoomEnd","toScaleValue","sign","deltaAdjustedSpeed","name","isNumber","failTransformOrigin","boundsType","validBounds","value","autoRun","scripts","panzoomScript","query","globalName","started","tryAttach","el","collectOptions","script","attrs","j","attr","nameValue","getPanzoomAttributeNameValue","isPanZoomAttribute","insert_hydration","div4","anchor","append_hydration","div2","div0","button0","div1","button1","div3","img","create_if_block","saveAs","fileSaver","show","$$props","alt","previewElement","sceneElement","handleKeyDown","event","onMount","onDestroy","$$invalidate","base64Data","blob","c","mimeType","fileName","response","blobWithType","error","$$value","div","button","img_src_value","className","imageClassName","dismissible","onDismiss","_src","showImagePreview","WEBUI_BASE_URL"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9]}