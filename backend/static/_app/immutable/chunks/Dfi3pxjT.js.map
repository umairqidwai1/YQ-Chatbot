{"version":3,"file":"Dfi3pxjT.js","sources":["../../../../../../src/lib/apis/notes/index.ts","../../../../../../src/lib/components/notes/Notes/NoteMenu.svelte"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\nimport { getTimeRange } from '$lib/utils';\n\ntype NoteItem = {\n\ttitle: string;\n\tdata: object;\n\tmeta?: null | object;\n\taccess_control?: null | object;\n};\n\nexport const createNewNote = async (token: string, note: NoteItem) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/create`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...note\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const getNotes = async (token: string = '') => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\tif (!Array.isArray(res)) {\n\t\treturn {}; // or throw new Error(\"Notes response is not an array\")\n\t}\n\n\t// Build the grouped object\n\tconst grouped: Record<string, any[]> = {};\n\tfor (const note of res) {\n\t\tconst timeRange = getTimeRange(note.updated_at / 1000000000);\n\t\tif (!grouped[timeRange]) {\n\t\t\tgrouped[timeRange] = [];\n\t\t}\n\t\tgrouped[timeRange].push({\n\t\t\t...note,\n\t\t\ttimeRange\n\t\t});\n\t}\n\n\treturn grouped;\n};\n\nexport const getNoteById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}`, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const updateNoteById = async (token: string, id: string, note: NoteItem) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}/update`, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\t...note\n\t\t})\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n\nexport const deleteNoteById = async (token: string, id: string) => {\n\tlet error = null;\n\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/notes/${id}/delete`, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\tAccept: 'application/json',\n\t\t\t'Content-Type': 'application/json',\n\t\t\tauthorization: `Bearer ${token}`\n\t\t}\n\t})\n\t\t.then(async (res) => {\n\t\t\tif (!res.ok) throw await res.json();\n\t\t\treturn res.json();\n\t\t})\n\t\t.then((json) => {\n\t\t\treturn json;\n\t\t})\n\t\t.catch((err) => {\n\t\t\terror = err.detail;\n\n\t\t\tconsole.error(err);\n\t\t\treturn null;\n\t\t});\n\n\tif (error) {\n\t\tthrow error;\n\t}\n\n\treturn res;\n};\n","<script lang=\"ts\">\n\timport { DropdownMenu } from 'bits-ui';\n\timport { getContext, onMount } from 'svelte';\n\n\timport { flyAndScale } from '$lib/utils/transitions';\n\timport { fade, slide } from 'svelte/transition';\n\n\timport { showSettings, mobile, showSidebar, user } from '$lib/stores';\n\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\n\timport ArchiveBox from '$lib/components/icons/ArchiveBox.svelte';\n\timport Download from '$lib/components/icons/Download.svelte';\n\timport GarbageBin from '$lib/components/icons/GarbageBin.svelte';\n\timport DocumentDuplicate from '$lib/components/icons/DocumentDuplicate.svelte';\n\timport Share from '$lib/components/icons/Share.svelte';\n\n\tconst i18n = getContext('i18n');\n\n\texport let show = false;\n\texport let className = 'max-w-[180px]';\n\n\texport let onDownload = (type) => {};\n\texport let onDelete = () => {};\n\texport let onCopyToClipboard = () => {};\n\n\texport let onChange = () => {};\n</script>\n\n<DropdownMenu.Root\n\tbind:open={show}\n\tonOpenChange={(state) => {\n\t\tonChange(state);\n\t}}\n>\n\t<DropdownMenu.Trigger>\n\t\t<slot />\n\t</DropdownMenu.Trigger>\n\n\t<slot name=\"content\">\n\t\t<DropdownMenu.Content\n\t\t\tclass=\"w-full {className} text-sm rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg font-primary\"\n\t\t\tsideOffset={6}\n\t\t\tside=\"bottom\"\n\t\t\talign=\"start\"\n\t\t\ttransition={(e) => fade(e, { duration: 100 })}\n\t\t>\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<Download strokeWidth=\"2\" />\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t>\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonDownload('md');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.md)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonDownload('pdf');\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\n\t\t\t<DropdownMenu.Sub>\n\t\t\t\t<DropdownMenu.SubTrigger\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t>\n\t\t\t\t\t<Share strokeWidth=\"2\" />\n\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\n\t\t\t\t</DropdownMenu.SubTrigger>\n\t\t\t\t<DropdownMenu.SubContent\n\t\t\t\t\tclass=\"w-full rounded-xl px-1 py-1.5 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\n\t\t\t\t\ttransition={flyAndScale}\n\t\t\t\t\tsideOffset={8}\n\t\t\t\t>\n\t\t\t\t\t<DropdownMenu.Item\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\t\t\ton:click={() => {\n\t\t\t\t\t\t\tonCopyToClipboard();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<DocumentDuplicate strokeWidth=\"2\" />\n\t\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Copy to clipboard')}</div>\n\t\t\t\t\t</DropdownMenu.Item>\n\t\t\t\t</DropdownMenu.SubContent>\n\t\t\t</DropdownMenu.Sub>\n\n\t\t\t<DropdownMenu.Item\n\t\t\t\tclass=\"flex  gap-2  items-center px-3 py-1.5 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\n\t\t\t\ton:click={() => {\n\t\t\t\t\tonDelete();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<GarbageBin strokeWidth=\"2\" />\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Delete')}</div>\n\t\t\t</DropdownMenu.Item>\n\t\t</DropdownMenu.Content>\n\t</slot>\n</DropdownMenu.Root>\n"],"names":["createNewNote","token","note","error","res","WEBUI_API_BASE_URL","err","getNotes","json","grouped","timeRange","getTimeRange","getNoteById","id","updateNoteById","deleteNoteById","ctx","insert_hydration","target","div","anchor","set_data","t1","t1_value","t_value","flyAndScale","i18n","getContext","show","$$props","className","onDownload","type","onDelete","onCopyToClipboard","onChange","func","e","fade","state","value"],"mappings":"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"}