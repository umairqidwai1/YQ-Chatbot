import{g as I}from"./BmtUElco.js";import{A as ot}from"./DB_xkffJ.js";import{b as at}from"./DuCCpQXh.js";import{Y as K,i as rt,a as F,b as ct,s as Ke,S as A,m as D,o as he,p as pe,c as de,M as lt,d as L,e as ft,f as ut,g as H,h as me,j as Ie,l as ht,N as Ae,D as $e,k as Q,n as pt,q as dt,A as Me,r as mt,t as v,P as Z,u as V,v as G,w as Oe,x as yt,y as gt,z as wt,B as qe,L as bt,C as kt,E as Tt}from"./BFK-koEx.js";import"./2lNU1ddO.js";import{t as St}from"./CPRQqKui.js";const q={collection:"map",default:!0,nodeClass:K,tag:"tag:yaml.org,2002:map",resolve(s,t){return rt(s)||t("Expected a mapping for this tag"),s},createNode:(s,t,e)=>K.from(s,t,e)},R={collection:"seq",default:!0,nodeClass:F,tag:"tag:yaml.org,2002:seq",resolve(s,t){return ct(s)||t("Expected a sequence for this tag"),s},createNode:(s,t,e)=>F.from(s,t,e)},ee={identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify(s,t,e,n){return t=Object.assign({actualString:!0},t),Ke(s,t,e,n)}},te={identify:s=>s==null,createNode:()=>new A(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new A(null),stringify:({source:s},t)=>typeof s=="string"&&te.test.test(s)?s:t.options.nullStr},ye={identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:s=>new A(s[0]==="t"||s[0]==="T"),stringify({source:s,value:t},e){if(s&&ye.test.test(s)){const n=s[0]==="t"||s[0]==="T";if(t===n)return s}return t?e.options.trueStr:e.options.falseStr}};function E({format:s,minFractionDigits:t,tag:e,value:n}){if(typeof n=="bigint")return String(n);const i=typeof n=="number"?n:Number(n);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=JSON.stringify(n);if(!s&&t&&(!e||e==="tag:yaml.org,2002:float")&&/^\d/.test(o)){let a=o.indexOf(".");a<0&&(a=o.length,o+=".");let r=t-(o.length-a-1);for(;r-- >0;)o+="0"}return o}const Re={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:E},Ue={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():E(s)}},xe={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(s){const t=new A(parseFloat(s)),e=s.indexOf(".");return e!==-1&&s[s.length-1]==="0"&&(t.minFractionDigits=s.length-e-1),t},stringify:E},se=s=>typeof s=="bigint"||Number.isInteger(s),ge=(s,t,e,{intAsBigInt:n})=>n?BigInt(s):parseInt(s.substring(t),e);function Fe(s,t,e){const{value:n}=s;return se(n)&&n>=0?e+n.toString(t):E(s)}const Ge={identify:s=>se(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(s,t,e)=>ge(s,2,8,e),stringify:s=>Fe(s,8,"0o")},Ye={identify:se,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(s,t,e)=>ge(s,0,10,e),stringify:E},Je={identify:s=>se(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(s,t,e)=>ge(s,2,16,e),stringify:s=>Fe(s,16,"0x")},Nt=[q,R,ee,te,ye,Ge,Ye,Je,Re,Ue,xe];function _e(s){return typeof s=="bigint"||Number.isInteger(s)}const W=({value:s})=>JSON.stringify(s),It=[{identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify:W},{identify:s=>s==null,createNode:()=>new A(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:W},{identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:s=>s==="true",stringify:W},{identify:_e,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(s,t,{intAsBigInt:e})=>e?BigInt(s):parseInt(s,10),stringify:({value:s})=>_e(s)?s.toString():JSON.stringify(s)},{identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:s=>parseFloat(s),stringify:W}],At={default:!0,tag:"",test:/^/,resolve(s,t){return t(`Unresolved plain scalar ${JSON.stringify(s)}`),s}},$t=[q,R].concat(It,At),we={identify:s=>s instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(s,t){if(typeof atob=="function"){const e=atob(s.replace(/[\n\r]/g,"")),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)n[i]=e.charCodeAt(i);return n}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),s},stringify({comment:s,type:t,value:e},n,i,o){if(!e)return"";const a=e;let r;if(typeof btoa=="function"){let c="";for(let l=0;l<a.length;++l)c+=String.fromCharCode(a[l]);r=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t||(t=A.BLOCK_LITERAL),t!==A.QUOTE_DOUBLE){const c=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),l=Math.ceil(r.length/c),h=new Array(l);for(let f=0,d=0;f<l;++f,d+=c)h[f]=r.substr(d,c);r=h.join(t===A.BLOCK_LITERAL?`
`:" ")}return Ke({comment:s,type:t,value:r},n,i,o)}};function ze({value:s,source:t},e){return t&&(s?He:Ve).test.test(t)?t:s?e.options.trueStr:e.options.falseStr}const He={identify:s=>s===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new A(!0),stringify:ze},Ve={identify:s=>s===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new A(!1),stringify:ze},Ot={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:E},_t={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s.replace(/_/g,"")),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():E(s)}},Et={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(s){const t=new A(parseFloat(s.replace(/_/g,""))),e=s.indexOf(".");if(e!==-1){const n=s.substring(e+1).replace(/_/g,"");n[n.length-1]==="0"&&(t.minFractionDigits=n.length)}return t},stringify:E},J=s=>typeof s=="bigint"||Number.isInteger(s);function ne(s,t,e,{intAsBigInt:n}){const i=s[0];if((i==="-"||i==="+")&&(t+=1),s=s.substring(t).replace(/_/g,""),n){switch(e){case 2:s=`0b${s}`;break;case 8:s=`0o${s}`;break;case 16:s=`0x${s}`;break}const a=BigInt(s);return i==="-"?BigInt(-1)*a:a}const o=parseInt(s,e);return i==="-"?-1*o:o}function be(s,t,e){const{value:n}=s;if(J(n)){const i=n.toString(t);return n<0?"-"+e+i.substr(1):e+i}return E(s)}const jt={identify:J,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(s,t,e)=>ne(s,2,2,e),stringify:s=>be(s,2,"0b")},vt={identify:J,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(s,t,e)=>ne(s,1,8,e),stringify:s=>be(s,8,"0")},Lt={identify:J,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(s,t,e)=>ne(s,0,10,e),stringify:E},Ct={identify:J,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(s,t,e)=>ne(s,2,16,e),stringify:s=>be(s,16,"0x")};function ke(s,t){const e=s[0],n=e==="-"||e==="+"?s.substring(1):s,i=a=>t?BigInt(a):Number(a),o=n.replace(/_/g,"").split(":").reduce((a,r)=>a*i(60)+i(r),i(0));return e==="-"?i(-1)*o:o}function We(s){let{value:t}=s,e=a=>a;if(typeof t=="bigint")e=a=>BigInt(a);else if(isNaN(t)||!isFinite(t))return E(s);let n="";t<0&&(n="-",t*=e(-1));const i=e(60),o=[t%i];return t<60?o.unshift(0):(t=(t-o[0])/i,o.unshift(t%i),t>=60&&(t=(t-o[0])/i,o.unshift(t))),n+o.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Xe={identify:s=>typeof s=="bigint"||Number.isInteger(s),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(s,t,{intAsBigInt:e})=>ke(s,e),stringify:We},Qe={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:s=>ke(s,!1),stringify:We},ie={identify:s=>s instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(s){const t=s.match(ie.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,e,n,i,o,a,r]=t.map(Number),c=t[7]?Number((t[7]+"00").substr(1,3)):0;let l=Date.UTC(e,n-1,i,o||0,a||0,r||0,c);const h=t[8];if(h&&h!=="Z"){let f=ke(h,!1);Math.abs(f)<30&&(f*=60),l-=6e4*f}return new Date(l)},stringify:({value:s})=>(s==null?void 0:s.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},Ee=[q,R,ee,te,He,Ve,jt,vt,Lt,Ct,Ot,_t,Et,we,D,he,pe,de,Xe,Qe,ie],je=new Map([["core",Nt],["failsafe",[q,R,ee]],["json",$t],["yaml11",Ee],["yaml-1.1",Ee]]),ve={binary:we,bool:ye,float:xe,floatExp:Ue,floatNaN:Re,floatTime:Qe,int:Ye,intHex:Je,intOct:Ge,intTime:Xe,map:q,merge:D,null:te,omap:he,pairs:pe,seq:R,set:de,timestamp:ie},Pt={"tag:yaml.org,2002:binary":we,"tag:yaml.org,2002:merge":D,"tag:yaml.org,2002:omap":he,"tag:yaml.org,2002:pairs":pe,"tag:yaml.org,2002:set":de,"tag:yaml.org,2002:timestamp":ie};function re(s,t,e){const n=je.get(t);if(n&&!s)return e&&!n.includes(D)?n.concat(D):n.slice();let i=n;if(!i)if(Array.isArray(s))i=[];else{const o=Array.from(je.keys()).filter(a=>a!=="yaml11").map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${o} or define customTags array`)}if(Array.isArray(s))for(const o of s)i=i.concat(o);else typeof s=="function"&&(i=s(i.slice()));return e&&(i=i.concat(D)),i.reduce((o,a)=>{const r=typeof a=="string"?ve[a]:a;if(!r){const c=JSON.stringify(a),l=Object.keys(ve).map(h=>JSON.stringify(h)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${l}`)}return o.includes(r)||o.push(r),o},[])}const Bt=(s,t)=>s.key<t.key?-1:s.key>t.key?1:0;class Te{constructor({compat:t,customTags:e,merge:n,resolveKnownTags:i,schema:o,sortMapEntries:a,toStringDefaults:r}){this.compat=Array.isArray(t)?re(t,"compat"):t?re(null,t):null,this.name=typeof o=="string"&&o||"core",this.knownTags=i?Pt:{},this.tags=re(e,this.name,n),this.toStringOptions=r??null,Object.defineProperty(this,lt,{value:q}),Object.defineProperty(this,L,{value:ee}),Object.defineProperty(this,ft,{value:R}),this.sortMapEntries=typeof a=="function"?a:a===!0?Bt:null}clone(){const t=Object.create(Te.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}}function Dt(s,t){var c;const e=[];let n=t.directives===!0;if(t.directives!==!1&&s.directives){const l=s.directives.toString(s);l?(e.push(l),n=!0):s.directives.docStart&&(n=!0)}n&&e.push("---");const i=ut(s,t),{commentString:o}=i.options;if(s.commentBefore){e.length!==1&&e.unshift("");const l=o(s.commentBefore);e.unshift(H(l,""))}let a=!1,r=null;if(s.contents){if(me(s.contents)){if(s.contents.spaceBefore&&n&&e.push(""),s.contents.commentBefore){const f=o(s.contents.commentBefore);e.push(H(f,""))}i.forceBlockIndent=!!s.comment,r=s.contents.comment}const l=r?void 0:()=>a=!0;let h=Ie(s.contents,i,()=>r=null,l);r&&(h+=ht(h,"",o(r))),(h[0]==="|"||h[0]===">")&&e[e.length-1]==="---"?e[e.length-1]=`--- ${h}`:e.push(h)}else e.push(Ie(s.contents,i));if((c=s.directives)!=null&&c.docEnd)if(s.comment){const l=o(s.comment);l.includes(`
`)?(e.push("..."),e.push(H(l,""))):e.push(`... ${l}`)}else e.push("...");else{let l=s.comment;l&&a&&(l=l.replace(/^\n+/,"")),l&&((!a||r)&&e[e.length-1]!==""&&e.push(""),e.push(H(o(l),"")))}return e.join(`
`)+`
`}class oe{constructor(t,e,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Ae,{value:$e});let i=null;typeof e=="function"||Array.isArray(e)?i=e:n===void 0&&e&&(n=e,e=void 0);const o=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},n);this.options=o;let{version:a}=o;n!=null&&n._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new Q({version:a}),this.setSchema(a,n),this.contents=t===void 0?null:this.createNode(t,i,n)}clone(){const t=Object.create(oe.prototype,{[Ae]:{value:$e}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=me(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){P(this.contents)&&this.contents.add(t)}addIn(t,e){P(this.contents)&&this.contents.addIn(t,e)}createAlias(t,e){if(!t.anchor){const n=pt(this);t.anchor=!e||n.has(e)?dt(e||"a",n):e}return new Me(t.anchor)}createNode(t,e,n){let i;if(typeof e=="function")t=e.call({"":t},"",t),i=e;else if(Array.isArray(e)){const m=S=>typeof S=="number"||S instanceof String||S instanceof Number,b=e.filter(m).map(String);b.length>0&&(e=e.concat(b)),i=e}else n===void 0&&e&&(n=e,e=void 0);const{aliasDuplicateObjects:o,anchorPrefix:a,flow:r,keepUndefined:c,onTagObj:l,tag:h}=n??{},{onAnchor:f,setAnchors:d,sourceObjects:u}=wt(this,a||"a"),g={aliasDuplicateObjects:o??!0,keepUndefined:c??!1,onAnchor:f,onTagObj:l,replacer:i,schema:this.schema,sourceObjects:u},p=mt(t,h,g);return r&&v(p)&&(p.flow=!0),d(),p}createPair(t,e,n={}){const i=this.createNode(t,null,n),o=this.createNode(e,null,n);return new Z(i,o)}delete(t){return P(this.contents)?this.contents.delete(t):!1}deleteIn(t){return V(t)?this.contents==null?!1:(this.contents=null,!0):P(this.contents)?this.contents.deleteIn(t):!1}get(t,e){return v(this.contents)?this.contents.get(t,e):void 0}getIn(t,e){return V(t)?!e&&G(this.contents)?this.contents.value:this.contents:v(this.contents)?this.contents.getIn(t,e):void 0}has(t){return v(this.contents)?this.contents.has(t):!1}hasIn(t){return V(t)?this.contents!==void 0:v(this.contents)?this.contents.hasIn(t):!1}set(t,e){this.contents==null?this.contents=Oe(this.schema,[t],e):P(this.contents)&&this.contents.set(t,e)}setIn(t,e){V(t)?this.contents=e:this.contents==null?this.contents=Oe(this.schema,Array.from(t),e):P(this.contents)&&this.contents.setIn(t,e)}setSchema(t,e={}){typeof t=="number"&&(t=String(t));let n;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Q({version:"1.1"}),n={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new Q({version:t}),n={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{const i=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(e.schema instanceof Object)this.schema=e.schema;else if(n)this.schema=new Te(Object.assign(n,e));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:e,mapAsMap:n,maxAliasCount:i,onAnchor:o,reviver:a}={}){const r={anchors:new Map,doc:this,keep:!t,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},c=yt(this.contents,e??"",r);if(typeof o=="function")for(const{count:l,res:h}of r.anchors.values())o(h,l);return typeof a=="function"?gt(a,{"":c},"",c):c}toJSON(t,e){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:e})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){const e=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${e}`)}return Dt(this,t)}}function P(s){if(v(s))return!0;throw new Error("Expected a YAML collection as document contents")}class Ze extends Error{constructor(t,e,n,i){super(),this.name=t,this.code=n,this.message=i,this.pos=e}}class x extends Ze{constructor(t,e,n){super("YAMLParseError",t,e,n)}}class Kt extends Ze{constructor(t,e,n){super("YAMLWarning",t,e,n)}}const Le=(s,t)=>e=>{if(e.pos[0]===-1)return;e.linePos=e.pos.map(r=>t.linePos(r));const{line:n,col:i}=e.linePos[0];e.message+=` at line ${n}, column ${i}`;let o=i-1,a=s.substring(t.lineStarts[n-1],t.lineStarts[n]).replace(/[\n\r]+$/,"");if(o>=60&&a.length>80){const r=Math.min(o-39,a.length-79);a="…"+a.substring(r),o-=r-1}if(a.length>80&&(a=a.substring(0,79)+"…"),n>1&&/^ *$/.test(a.substring(0,o))){let r=s.substring(t.lineStarts[n-2],t.lineStarts[n-1]);r.length>80&&(r=r.substring(0,79)+`…
`),a=r+a}if(/[^ ]/.test(a)){let r=1;const c=e.linePos[1];c&&c.line===n&&c.col>i&&(r=Math.max(1,Math.min(c.col-i,80-o)));const l=" ".repeat(o)+"^".repeat(r);e.message+=`:

${a}
${l}
`}};function M(s,{flow:t,indicator:e,next:n,offset:i,onError:o,parentIndent:a,startOnNewline:r}){let c=!1,l=r,h=r,f="",d="",u=!1,g=!1,p=null,m=null,b=null,S=null,w=null,k=null,N=null;for(const y of s)switch(g&&(y.type!=="space"&&y.type!=="newline"&&y.type!=="comma"&&o(y.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g=!1),p&&(l&&y.type!=="comment"&&y.type!=="newline"&&o(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),p=null),y.type){case"space":!t&&(e!=="doc-start"||(n==null?void 0:n.type)!=="flow-collection")&&y.source.includes("	")&&(p=y),h=!0;break;case"comment":{h||o(y,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const $=y.source.substring(1)||" ";f?f+=d+$:f=$,d="",l=!1;break}case"newline":l?f?f+=y.source:(!k||e!=="seq-item-ind")&&(c=!0):d+=y.source,l=!0,u=!0,(m||b)&&(S=y),h=!0;break;case"anchor":m&&o(y,"MULTIPLE_ANCHORS","A node can have at most one anchor"),y.source.endsWith(":")&&o(y.offset+y.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),m=y,N===null&&(N=y.offset),l=!1,h=!1,g=!0;break;case"tag":{b&&o(y,"MULTIPLE_TAGS","A node can have at most one tag"),b=y,N===null&&(N=y.offset),l=!1,h=!1,g=!0;break}case e:(m||b)&&o(y,"BAD_PROP_ORDER",`Anchors and tags must be after the ${y.source} indicator`),k&&o(y,"UNEXPECTED_TOKEN",`Unexpected ${y.source} in ${t??"collection"}`),k=y,l=e==="seq-item-ind"||e==="explicit-key-ind",h=!1;break;case"comma":if(t){w&&o(y,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),w=y,l=!1,h=!1;break}default:o(y,"UNEXPECTED_TOKEN",`Unexpected ${y.type} token`),l=!1,h=!1}const T=s[s.length-1],O=T?T.offset+T.source.length:i;return g&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&o(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p&&(l&&p.indent<=a||(n==null?void 0:n.type)==="block-map"||(n==null?void 0:n.type)==="block-seq")&&o(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:w,found:k,spaceBefore:c,comment:f,hasNewline:u,anchor:m,tag:b,newlineAfterProp:S,end:O,start:N??O}}function Y(s){if(!s)return null;switch(s.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(s.source.includes(`
`))return!0;if(s.end){for(const t of s.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(const t of s.items){for(const e of t.start)if(e.type==="newline")return!0;if(t.sep){for(const e of t.sep)if(e.type==="newline")return!0}if(Y(t.key)||Y(t.value))return!0}return!1;default:return!0}}function ue(s,t,e){if((t==null?void 0:t.type)==="flow-collection"){const n=t.end[0];n.indent===s&&(n.source==="]"||n.source==="}")&&Y(t)&&e(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function et(s,t,e){const{uniqueKeys:n}=s.options;if(n===!1)return!1;const i=typeof n=="function"?n:(o,a)=>o===a||G(o)&&G(a)&&o.value===a.value;return t.some(o=>i(o.key,e))}const Ce="All mapping items must start at the same column";function Mt({composeNode:s,composeEmptyNode:t},e,n,i,o){var h;const a=(o==null?void 0:o.nodeClass)??K,r=new a(e.schema);e.atRoot&&(e.atRoot=!1);let c=n.offset,l=null;for(const f of n.items){const{start:d,key:u,sep:g,value:p}=f,m=M(d,{indicator:"explicit-key-ind",next:u??(g==null?void 0:g[0]),offset:c,onError:i,parentIndent:n.indent,startOnNewline:!0}),b=!m.found;if(b){if(u&&(u.type==="block-seq"?i(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in u&&u.indent!==n.indent&&i(c,"BAD_INDENT",Ce)),!m.anchor&&!m.tag&&!g){l=m.end,m.comment&&(r.comment?r.comment+=`
`+m.comment:r.comment=m.comment);continue}(m.newlineAfterProp||Y(u))&&i(u??d[d.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((h=m.found)==null?void 0:h.indent)!==n.indent&&i(c,"BAD_INDENT",Ce);e.atKey=!0;const S=m.end,w=u?s(e,u,m,i):t(e,S,d,null,m,i);e.schema.compat&&ue(n.indent,u,i),e.atKey=!1,et(e,r.items,w)&&i(S,"DUPLICATE_KEY","Map keys must be unique");const k=M(g??[],{indicator:"map-value-ind",next:p,offset:w.range[2],onError:i,parentIndent:n.indent,startOnNewline:!u||u.type==="block-scalar"});if(c=k.end,k.found){b&&((p==null?void 0:p.type)==="block-map"&&!k.hasNewline&&i(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),e.options.strict&&m.start<k.found.offset-1024&&i(w.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const N=p?s(e,p,k,i):t(e,c,g,null,k,i);e.schema.compat&&ue(n.indent,p,i),c=N.range[2];const T=new Z(w,N);e.options.keepSourceTokens&&(T.srcToken=f),r.items.push(T)}else{b&&i(w.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),k.comment&&(w.comment?w.comment+=`
`+k.comment:w.comment=k.comment);const N=new Z(w);e.options.keepSourceTokens&&(N.srcToken=f),r.items.push(N)}}return l&&l<c&&i(l,"IMPOSSIBLE","Map comment with trailing content"),r.range=[n.offset,c,l??c],r}function qt({composeNode:s,composeEmptyNode:t},e,n,i,o){const a=(o==null?void 0:o.nodeClass)??F,r=new a(e.schema);e.atRoot&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let c=n.offset,l=null;for(const{start:h,value:f}of n.items){const d=M(h,{indicator:"seq-item-ind",next:f,offset:c,onError:i,parentIndent:n.indent,startOnNewline:!0});if(!d.found)if(d.anchor||d.tag||f)f&&f.type==="block-seq"?i(d.end,"BAD_INDENT","All sequence items must start at the same column"):i(c,"MISSING_CHAR","Sequence item without - indicator");else{l=d.end,d.comment&&(r.comment=d.comment);continue}const u=f?s(e,f,d,i):t(e,d.end,h,null,d,i);e.schema.compat&&ue(n.indent,f,i),c=u.range[2],r.items.push(u)}return r.range=[n.offset,c,l??c],r}function z(s,t,e,n){let i="";if(s){let o=!1,a="";for(const r of s){const{source:c,type:l}=r;switch(l){case"space":o=!0;break;case"comment":{e&&!o&&n(r,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=c.substring(1)||" ";i?i+=a+h:i=h,a="";break}case"newline":i&&(a+=c),o=!0;break;default:n(r,"UNEXPECTED_TOKEN",`Unexpected ${l} at node end`)}t+=c.length}}return{comment:i,offset:t}}const ce="Block collections are not allowed within flow collections",le=s=>s&&(s.type==="block-map"||s.type==="block-seq");function Rt({composeNode:s,composeEmptyNode:t},e,n,i,o){const a=n.start.source==="{",r=a?"flow map":"flow sequence",c=(o==null?void 0:o.nodeClass)??(a?K:F),l=new c(e.schema);l.flow=!0;const h=e.atRoot;h&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let f=n.offset+n.start.source.length;for(let m=0;m<n.items.length;++m){const b=n.items[m],{start:S,key:w,sep:k,value:N}=b,T=M(S,{flow:r,indicator:"explicit-key-ind",next:w??(k==null?void 0:k[0]),offset:f,onError:i,parentIndent:n.indent,startOnNewline:!1});if(!T.found){if(!T.anchor&&!T.tag&&!k&&!N){m===0&&T.comma?i(T.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`):m<n.items.length-1&&i(T.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${r}`),T.comment&&(l.comment?l.comment+=`
`+T.comment:l.comment=T.comment),f=T.end;continue}!a&&e.options.strict&&Y(w)&&i(w,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(m===0)T.comma&&i(T.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${r}`);else if(T.comma||i(T.start,"MISSING_CHAR",`Missing , between ${r} items`),T.comment){let O="";e:for(const y of S)switch(y.type){case"comma":case"space":break;case"comment":O=y.source.substring(1);break e;default:break e}if(O){let y=l.items[l.items.length-1];qe(y)&&(y=y.value??y.key),y.comment?y.comment+=`
`+O:y.comment=O,T.comment=T.comment.substring(O.length+1)}}if(!a&&!k&&!T.found){const O=N?s(e,N,T,i):t(e,T.end,k,null,T,i);l.items.push(O),f=O.range[2],le(N)&&i(O.range,"BLOCK_IN_FLOW",ce)}else{e.atKey=!0;const O=T.end,y=w?s(e,w,T,i):t(e,O,S,null,T,i);le(w)&&i(y.range,"BLOCK_IN_FLOW",ce),e.atKey=!1;const $=M(k??[],{flow:r,indicator:"map-value-ind",next:N,offset:y.range[2],onError:i,parentIndent:n.indent,startOnNewline:!1});if($.found){if(!a&&!T.found&&e.options.strict){if(k)for(const _ of k){if(_===$.found)break;if(_.type==="newline"){i(_,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}T.start<$.found.offset-1024&&i($.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else N&&("source"in N&&N.source&&N.source[0]===":"?i(N,"MISSING_CHAR",`Missing space after : in ${r}`):i($.start,"MISSING_CHAR",`Missing , or : between ${r} items`));const C=N?s(e,N,$,i):$.found?t(e,$.end,k,null,$,i):null;C?le(N)&&i(C.range,"BLOCK_IN_FLOW",ce):$.comment&&(y.comment?y.comment+=`
`+$.comment:y.comment=$.comment);const ae=new Z(y,C);if(e.options.keepSourceTokens&&(ae.srcToken=b),a){const _=l;et(e,_.items,y)&&i(O,"DUPLICATE_KEY","Map keys must be unique"),_.items.push(ae)}else{const _=new K(e.schema);_.flow=!0,_.items.push(ae);const Ne=(C??y).range;_.range=[y.range[0],Ne[1],Ne[2]],l.items.push(_)}f=C?C.range[2]:$.end}}const d=a?"}":"]",[u,...g]=n.end;let p=f;if(u&&u.source===d)p=u.offset+u.source.length;else{const m=r[0].toUpperCase()+r.substring(1),b=h?`${m} must end with a ${d}`:`${m} in block collection must be sufficiently indented and end with a ${d}`;i(f,h?"MISSING_CHAR":"BAD_INDENT",b),u&&u.source.length!==1&&g.unshift(u)}if(g.length>0){const m=z(g,p,e.options.strict,i);m.comment&&(l.comment?l.comment+=`
`+m.comment:l.comment=m.comment),l.range=[n.offset,p,m.offset]}else l.range=[n.offset,p,p];return l}function fe(s,t,e,n,i,o){const a=e.type==="block-map"?Mt(s,t,e,n,o):e.type==="block-seq"?qt(s,t,e,n,o):Rt(s,t,e,n,o),r=a.constructor;return i==="!"||i===r.tagName?(a.tag=r.tagName,a):(i&&(a.tag=i),a)}function Ut(s,t,e,n,i){var d;const o=n.tag,a=o?t.directives.tagName(o.source,u=>i(o,"TAG_RESOLVE_FAILED",u)):null;if(e.type==="block-seq"){const{anchor:u,newlineAfterProp:g}=n,p=u&&o?u.offset>o.offset?u:o:u??o;p&&(!g||g.offset<p.offset)&&i(p,"MISSING_CHAR","Missing newline after block sequence props")}const r=e.type==="block-map"?"map":e.type==="block-seq"?"seq":e.start.source==="{"?"map":"seq";if(!o||!a||a==="!"||a===K.tagName&&r==="map"||a===F.tagName&&r==="seq")return fe(s,t,e,i,a);let c=t.schema.tags.find(u=>u.tag===a&&u.collection===r);if(!c){const u=t.schema.knownTags[a];if(u&&u.collection===r)t.schema.tags.push(Object.assign({},u,{default:!1})),c=u;else return u?i(o,"BAD_COLLECTION_TYPE",`${u.tag} used for ${r} collection, but expects ${u.collection??"scalar"}`,!0):i(o,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),fe(s,t,e,i,a)}const l=fe(s,t,e,i,a,c),h=((d=c.resolve)==null?void 0:d.call(c,l,u=>i(o,"TAG_RESOLVE_FAILED",u),t.options))??l,f=me(h)?h:new A(h);return f.range=l.range,f.tag=a,c!=null&&c.format&&(f.format=c.format),f}function xt(s,t,e){const n=t.offset,i=Ft(t,s.options.strict,e);if(!i)return{value:"",type:null,comment:"",range:[n,n,n]};const o=i.mode===">"?A.BLOCK_FOLDED:A.BLOCK_LITERAL,a=t.source?Gt(t.source):[];let r=a.length;for(let p=a.length-1;p>=0;--p){const m=a[p][1];if(m===""||m==="\r")r=p;else break}if(r===0){const p=i.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"";let m=n+i.length;return t.source&&(m+=t.source.length),{value:p,type:o,comment:i.comment,range:[n,m,m]}}let c=t.indent+i.indent,l=t.offset+i.length,h=0;for(let p=0;p<r;++p){const[m,b]=a[p];if(b===""||b==="\r")i.indent===0&&m.length>c&&(c=m.length);else{m.length<c&&e(l+m.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(c=m.length),h=p,c===0&&!s.atRoot&&e(l,"BAD_INDENT","Block scalar values in collections must be indented");break}l+=m.length+b.length+1}for(let p=a.length-1;p>=r;--p)a[p][0].length>c&&(r=p+1);let f="",d="",u=!1;for(let p=0;p<h;++p)f+=a[p][0].slice(c)+`
`;for(let p=h;p<r;++p){let[m,b]=a[p];l+=m.length+b.length+1;const S=b[b.length-1]==="\r";if(S&&(b=b.slice(0,-1)),b&&m.length<c){const k=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;e(l-b.length-(S?2:1),"BAD_INDENT",k),m=""}o===A.BLOCK_LITERAL?(f+=d+m.slice(c)+b,d=`
`):m.length>c||b[0]==="	"?(d===" "?d=`
`:!u&&d===`
`&&(d=`

`),f+=d+m.slice(c)+b,d=`
`,u=!0):b===""?d===`
`?f+=`
`:d=`
`:(f+=d+b,d=" ",u=!1)}switch(i.chomp){case"-":break;case"+":for(let p=r;p<a.length;++p)f+=`
`+a[p][0].slice(c);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}const g=n+i.length+t.source.length;return{value:f,type:o,comment:i.comment,range:[n,g,g]}}function Ft({offset:s,props:t},e,n){if(t[0].type!=="block-scalar-header")return n(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=t[0],o=i[0];let a=0,r="",c=-1;for(let d=1;d<i.length;++d){const u=i[d];if(!r&&(u==="-"||u==="+"))r=u;else{const g=Number(u);!a&&g?a=g:c===-1&&(c=s+d)}}c!==-1&&n(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let l=!1,h="",f=i.length;for(let d=1;d<t.length;++d){const u=t[d];switch(u.type){case"space":l=!0;case"newline":f+=u.source.length;break;case"comment":e&&!l&&n(u,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=u.source.length,h=u.source.substring(1);break;case"error":n(u,"UNEXPECTED_TOKEN",u.message),f+=u.source.length;break;default:{const g=`Unexpected token in block scalar header: ${u.type}`;n(u,"UNEXPECTED_TOKEN",g);const p=u.source;p&&typeof p=="string"&&(f+=p.length)}}}return{mode:o,indent:a,chomp:r,comment:h,length:f}}function Gt(s){const t=s.split(/\n( *)/),e=t[0],n=e.match(/^( *)/),o=[n!=null&&n[1]?[n[1],e.slice(n[1].length)]:["",e]];for(let a=1;a<t.length;a+=2)o.push([t[a],t[a+1]]);return o}function Yt(s,t,e){const{offset:n,type:i,source:o,end:a}=s;let r,c;const l=(d,u,g)=>e(n+d,u,g);switch(i){case"scalar":r=A.PLAIN,c=Jt(o,l);break;case"single-quoted-scalar":r=A.QUOTE_SINGLE,c=zt(o,l);break;case"double-quoted-scalar":r=A.QUOTE_DOUBLE,c=Ht(o,l);break;default:return e(s,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[n,n+o.length,n+o.length]}}const h=n+o.length,f=z(a,h,t,e);return{value:c,type:r,comment:f.comment,range:[n,h,f.offset]}}function Jt(s,t){let e="";switch(s[0]){case"	":e="a tab character";break;case",":e="flow indicator character ,";break;case"%":e="directive indicator character %";break;case"|":case">":{e=`block scalar indicator ${s[0]}`;break}case"@":case"`":{e=`reserved character ${s[0]}`;break}}return e&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${e}`),tt(s)}function zt(s,t){return(s[s.length-1]!=="'"||s.length===1)&&t(s.length,"MISSING_CHAR","Missing closing 'quote"),tt(s.slice(1,-1)).replace(/''/g,"'")}function tt(s){let t,e;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),e=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,e=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=t.exec(s);if(!n)return s;let i=n[1],o=" ",a=t.lastIndex;for(e.lastIndex=a;n=e.exec(s);)n[1]===""?o===`
`?i+=o:o=`
`:(i+=o+n[1],o=" "),a=e.lastIndex;const r=/[ \t]*(.*)/sy;return r.lastIndex=a,n=r.exec(s),i+o+((n==null?void 0:n[1])??"")}function Ht(s,t){let e="";for(let n=1;n<s.length-1;++n){const i=s[n];if(!(i==="\r"&&s[n+1]===`
`))if(i===`
`){const{fold:o,offset:a}=Vt(s,n);e+=o,n=a}else if(i==="\\"){let o=s[++n];const a=Wt[o];if(a)e+=a;else if(o===`
`)for(o=s[n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="\r"&&s[n+1]===`
`)for(o=s[++n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="x"||o==="u"||o==="U"){const r={x:2,u:4,U:8}[o];e+=Xt(s,n+1,r,t),n+=r}else{const r=s.substr(n-1,2);t(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),e+=r}}else if(i===" "||i==="	"){const o=n;let a=s[n+1];for(;a===" "||a==="	";)a=s[++n+1];a!==`
`&&!(a==="\r"&&s[n+2]===`
`)&&(e+=n>o?s.slice(o,n+1):i)}else e+=i}return(s[s.length-1]!=='"'||s.length===1)&&t(s.length,"MISSING_CHAR",'Missing closing "quote'),e}function Vt(s,t){let e="",n=s[t+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&s[t+2]!==`
`);)n===`
`&&(e+=`
`),t+=1,n=s[t+1];return e||(e=" "),{fold:e,offset:t}}const Wt={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Xt(s,t,e,n){const i=s.substr(t,e),a=i.length===e&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(a)){const r=s.substr(t-2,e+2);return n(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${r}`),r}return String.fromCodePoint(a)}function st(s,t,e,n){const{value:i,type:o,comment:a,range:r}=t.type==="block-scalar"?xt(s,t,n):Yt(t,s.options.strict,n),c=e?s.directives.tagName(e.source,f=>n(e,"TAG_RESOLVE_FAILED",f)):null;let l;s.options.stringKeys&&s.atKey?l=s.schema[L]:c?l=Qt(s.schema,i,c,e,n):t.type==="scalar"?l=Zt(s,i,t,n):l=s.schema[L];let h;try{const f=l.resolve(i,d=>n(e??t,"TAG_RESOLVE_FAILED",d),s.options);h=G(f)?f:new A(f)}catch(f){const d=f instanceof Error?f.message:String(f);n(e??t,"TAG_RESOLVE_FAILED",d),h=new A(i)}return h.range=r,h.source=i,o&&(h.type=o),c&&(h.tag=c),l.format&&(h.format=l.format),a&&(h.comment=a),h}function Qt(s,t,e,n,i){var r;if(e==="!")return s[L];const o=[];for(const c of s.tags)if(!c.collection&&c.tag===e)if(c.default&&c.test)o.push(c);else return c;for(const c of o)if((r=c.test)!=null&&r.test(t))return c;const a=s.knownTags[e];return a&&!a.collection?(s.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(i(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${e}`,e!=="tag:yaml.org,2002:str"),s[L])}function Zt({atKey:s,directives:t,schema:e},n,i,o){const a=e.tags.find(r=>{var c;return(r.default===!0||s&&r.default==="key")&&((c=r.test)==null?void 0:c.test(n))})||e[L];if(e.compat){const r=e.compat.find(c=>{var l;return c.default&&((l=c.test)==null?void 0:l.test(n))})??e[L];if(a.tag!==r.tag){const c=t.tagString(a.tag),l=t.tagString(r.tag),h=`Value may be parsed as either ${c} or ${l}`;o(i,"TAG_RESOLVE_FAILED",h,!0)}}return a}function es(s,t,e){if(t){e===null&&(e=t.length);for(let n=e-1;n>=0;--n){let i=t[n];switch(i.type){case"space":case"comment":case"newline":s-=i.source.length;continue}for(i=t[++n];(i==null?void 0:i.type)==="space";)s+=i.source.length,i=t[++n];break}}return s}const ts={composeNode:nt,composeEmptyNode:Se};function nt(s,t,e,n){const i=s.atKey,{spaceBefore:o,comment:a,anchor:r,tag:c}=e;let l,h=!0;switch(t.type){case"alias":l=ss(s,t,n),(r||c)&&n(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":l=st(s,t,c,n),r&&(l.anchor=r.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":l=Ut(ts,s,t,e,n),r&&(l.anchor=r.source.substring(1));break;default:{const f=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;n(t,"UNEXPECTED_TOKEN",f),l=Se(s,t.offset,void 0,null,e,n),h=!1}}return r&&l.anchor===""&&n(r,"BAD_ALIAS","Anchor cannot be an empty string"),i&&s.options.stringKeys&&(!G(l)||typeof l.value!="string"||l.tag&&l.tag!=="tag:yaml.org,2002:str")&&n(c??t,"NON_STRING_KEY","With stringKeys, all keys must be strings"),o&&(l.spaceBefore=!0),a&&(t.type==="scalar"&&t.source===""?l.comment=a:l.commentBefore=a),s.options.keepSourceTokens&&h&&(l.srcToken=t),l}function Se(s,t,e,n,{spaceBefore:i,comment:o,anchor:a,tag:r,end:c},l){const h={type:"scalar",offset:es(t,e,n),indent:-1,source:""},f=st(s,h,r,l);return a&&(f.anchor=a.source.substring(1),f.anchor===""&&l(a,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(f.spaceBefore=!0),o&&(f.comment=o,f.range[2]=c),f}function ss({options:s},{offset:t,source:e,end:n},i){const o=new Me(e.substring(1));o.source===""&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(t+e.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const a=t+e.length,r=z(n,a,s.strict,i);return o.range=[t,a,r.offset],r.comment&&(o.comment=r.comment),o}function ns(s,t,{offset:e,start:n,value:i,end:o},a){const r=Object.assign({_directives:t},s),c=new oe(void 0,r),l={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},h=M(n,{indicator:"doc-start",next:i??(o==null?void 0:o[0]),offset:e,onError:a,parentIndent:0,startOnNewline:!0});h.found&&(c.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!h.hasNewline&&a(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=i?nt(l,i,h,a):Se(l,h.end,n,null,h,a);const f=c.contents.range[2],d=z(o,f,!1,a);return d.comment&&(c.comment=d.comment),c.range=[e,f,d.offset],c}function U(s){if(typeof s=="number")return[s,s+1];if(Array.isArray(s))return s.length===2?s:[s[0],s[1]];const{offset:t,source:e}=s;return[t,t+(typeof e=="string"?e.length:1)]}function Pe(s){var i;let t="",e=!1,n=!1;for(let o=0;o<s.length;++o){const a=s[o];switch(a[0]){case"#":t+=(t===""?"":n?`

`:`
`)+(a.substring(1)||" "),e=!0,n=!1;break;case"%":((i=s[o+1])==null?void 0:i[0])!=="#"&&(o+=1),e=!1;break;default:e||(n=!0),e=!1}}return{comment:t,afterEmptyLine:n}}class is{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,n,i,o)=>{const a=U(e);o?this.warnings.push(new Kt(a,n,i)):this.errors.push(new x(a,n,i))},this.directives=new Q({version:t.version||"1.2"}),this.options=t}decorate(t,e){const{comment:n,afterEmptyLine:i}=Pe(this.prelude);if(n){const o=t.contents;if(e)t.comment=t.comment?`${t.comment}
${n}`:n;else if(i||t.directives.docStart||!o)t.commentBefore=n;else if(v(o)&&!o.flow&&o.items.length>0){let a=o.items[0];qe(a)&&(a=a.key);const r=a.commentBefore;a.commentBefore=r?`${n}
${r}`:n}else{const a=o.commentBefore;o.commentBefore=a?`${n}
${a}`:n}}e?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Pe(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,e=!1,n=-1){for(const i of t)yield*this.next(i);yield*this.end(e,n)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(e,n,i)=>{const o=U(t);o[0]+=e,this.onError(o,"BAD_DIRECTIVE",n,i)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{const e=ns(this.options,this.directives,t,this.onError);this.atDirectives&&!e.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(e,!1),this.doc&&(yield this.doc),this.doc=e,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{const e=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,n=new x(U(t),"UNEXPECTED_TOKEN",e);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){const n="Unexpected doc-end without preceding document";this.errors.push(new x(U(t),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;const e=z(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),e.comment){const n=this.doc.comment;this.doc.comment=n?`${n}
${e.comment}`:e.comment}this.doc.range[2]=e.offset;break}default:this.errors.push(new x(U(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,e=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){const n=Object.assign({_directives:this.directives},this.options),i=new oe(void 0,n);this.atDirectives&&this.onError(e,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,e,e],this.decorate(i,!1),yield i}}}class os{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let e=0,n=this.lineStarts.length;for(;e<n;){const o=e+n>>1;this.lineStarts[o]<t?e=o+1:n=o}if(this.lineStarts[e]===t)return{line:e+1,col:1};if(e===0)return{line:0,col:t};const i=this.lineStarts[e-1];return{line:e,col:t-i+1}}}}function j(s,t){for(let e=0;e<s.length;++e)if(s[e].type===t)return!0;return!1}function Be(s){for(let t=0;t<s.length;++t)switch(s[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function it(s){switch(s==null?void 0:s.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function X(s){switch(s.type){case"document":return s.start;case"block-map":{const t=s.items[s.items.length-1];return t.sep??t.start}case"block-seq":return s.items[s.items.length-1].start;default:return[]}}function B(s){var e;if(s.length===0)return[];let t=s.length;e:for(;--t>=0;)switch(s[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((e=s[++t])==null?void 0:e.type)==="space";);return s.splice(t,s.length)}function De(s){if(s.start.type==="flow-seq-start")for(const t of s.items)t.sep&&!t.value&&!j(t.start,"explicit-key-ind")&&!j(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,it(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class as{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new bt,this.onNewLine=t}*parse(t,e=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const n of this.lexer.lex(t,e))yield*this.next(n);e||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}const e=kt(t);if(e)if(e==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=e,yield*this.step(),e){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{const n=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const t=this.peek(1);if(this.type==="doc-end"&&(!t||t.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){const e=t??this.stack.pop();if(!e)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield e;else{const n=this.peek(1);switch(e.type==="block-scalar"?e.indent="indent"in n?n.indent:0:e.type==="flow-collection"&&n.type==="document"&&(e.indent=0),e.type==="flow-collection"&&De(e),n.type){case"document":n.value=e;break;case"block-scalar":n.props.push(e);break;case"block-map":{const i=n.items[n.items.length-1];if(i.value){n.items.push({start:[],key:e,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=e;else{Object.assign(i,{key:e,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=n.items[n.items.length-1];i.value?n.items.push({start:[],value:e}):i.value=e;break}case"flow-collection":{const i=n.items[n.items.length-1];!i||i.value?n.items.push({start:[],key:e,sep:[]}):i.sep?i.value=e:Object.assign(i,{key:e,sep:[]});return}default:yield*this.pop(),yield*this.pop(e)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(e.type==="block-map"||e.type==="block-seq")){const i=e.items[e.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&Be(i.start)===-1&&(e.indent===0||i.start.every(o=>o.type!=="comment"||o.indent<e.indent))&&(n.type==="document"?n.end=i.start:n.items.push({start:i.start}),e.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{Be(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}const e=this.startBlockValue(t);e?this.stack.push(e):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){const e=X(this.peek(2)),n=B(e);let i;t.end?(i=t.end,i.push(this.sourceToken),delete t.end):i=[this.sourceToken];const o={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:n,key:t,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=o}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,e.value){const i="end"in e.value?e.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else if(e.sep)e.sep.push(this.sourceToken);else{if(this.atIndentedComment(e.start,t.indent)){const i=t.items[t.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,e.start),o.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return}if(this.indent>=t.indent){const i=!this.onKeyLine&&this.indent===t.indent,o=i&&(e.sep||e.explicitKey)&&this.type!=="seq-item-ind";let a=[];if(o&&e.sep&&!e.value){const r=[];for(let c=0;c<e.sep.length;++c){const l=e.sep[c];switch(l.type){case"newline":r.push(c);break;case"space":break;case"comment":l.indent>t.indent&&(r.length=0);break;default:r.length=0}}r.length>=2&&(a=e.sep.splice(r[1]))}switch(this.type){case"anchor":case"tag":o||e.value?(a.push(this.sourceToken),t.items.push({start:a}),this.onKeyLine=!0):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"explicit-key-ind":!e.sep&&!e.explicitKey?(e.start.push(this.sourceToken),e.explicitKey=!0):o||e.value?(a.push(this.sourceToken),t.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(e.explicitKey)if(e.sep)if(e.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(j(e.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(it(e.key)&&!j(e.sep,"newline")){const r=B(e.start),c=e.key,l=e.sep;l.push(this.sourceToken),delete e.key,delete e.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:c,sep:l}]})}else a.length>0?e.sep=e.sep.concat(a,this.sourceToken):e.sep.push(this.sourceToken);else if(j(e.start,"newline"))Object.assign(e,{key:null,sep:[this.sourceToken]});else{const r=B(e.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]})}else e.sep?e.value||o?t.items.push({start:a,key:null,sep:[this.sourceToken]}):j(e.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);o||e.value?(t.items.push({start:a,key:r,sep:[]}),this.onKeyLine=!0):e.sep?this.stack.push(r):(Object.assign(e,{key:r,sep:[]}),this.onKeyLine=!0);return}default:{const r=this.startBlockValue(t);if(r){if(r.type==="block-seq"){if(!e.explicitKey&&e.sep&&!j(e.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&t.items.push({start:a});this.stack.push(r);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(e.value){const i="end"in e.value?e.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(e.start,t.indent)){const i=t.items[t.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,e.start),o.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return;case"anchor":case"tag":if(e.value||this.indent<=t.indent)break;e.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;e.value||j(e.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return}if(this.indent>t.indent){const i=this.startBlockValue(t);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){const e=t.items[t.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!e||e.sep?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return;case"map-value-ind":!e||e.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!e||e.value?t.items.push({start:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!e||e.value?t.items.push({start:[],key:i,sep:[]}):e.sep?this.stack.push(i):Object.assign(e,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}const n=this.startBlockValue(t);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{const n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===t.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){const i=X(n),o=B(i);De(t);const a=t.end.splice(1,t.end.length);a.push(this.sourceToken);const r={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:o,key:t,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=r}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const e=X(t),n=B(e);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const e=X(t),n=B(e);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,e){return this.type!=="comment"||this.indent<=e?!1:t.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function rs(s){const t=s.prettyErrors!==!1;return{lineCounter:s.lineCounter||t&&new os||null,prettyErrors:t}}function cs(s,t={}){const{lineCounter:e,prettyErrors:n}=rs(t),i=new as(e==null?void 0:e.addNewLine),o=new is(t);let a=null;for(const r of o.compose(i.parse(s),!0,s.length))if(!a)a=r;else if(a.options.logLevel!=="silent"){a.errors.push(new x(r.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&e&&(a.errors.forEach(Le(s,e)),a.warnings.forEach(Le(s,e))),a}function ls(s,t,e){let n;const i=cs(s,e);if(!i)return null;if(i.warnings.forEach(o=>Tt(i.options.logLevel,o)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:n},e))}const gs=async(s="",t=null,e=!1)=>{let n=null;const i=await fetch(`${I}/api/models${e?"/base":""}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(n=a,console.error(a),null));if(n)throw n;let o=(i==null?void 0:i.data)??[];if(t&&!e){let a=[];if(t){const c=t.OPENAI_API_BASE_URLS,l=t.OPENAI_API_KEYS,h=t.OPENAI_API_CONFIGS,f=[];for(const u in c){const g=c[u];if(u.toString()in h){const p=h[u.toString()]??{},m=(p==null?void 0:p.enable)??!0,b=(p==null?void 0:p.model_ids)??[];if(m)if(b.length>0){const S={object:"list",data:b.map(w=>({id:w,name:w,owned_by:"openai",openai:{id:w},urlIdx:u}))};f.push((async()=>S)())}else f.push((async()=>await at(g,l[u]).then(S=>S).catch(S=>({object:"list",data:[],urlIdx:u})))());else f.push((async()=>({object:"list",data:[],urlIdx:u}))())}}const d=await Promise.all(f);for(const u in d){const g=d[u],p=h[u.toString()]??{};let m=Array.isArray(g)?g:(g==null?void 0:g.data)??[];m=m.map(w=>({...w,openai:{id:w.id},urlIdx:u}));const b=p.prefix_id;if(b)for(const w of m)w.id=`${b}.${w.id}`;const S=p.tags;if(S)for(const w of m)w.tags=S;a=a.concat(m)}}o=o.concat(a.map(c=>({...c,name:(c==null?void 0:c.name)??(c==null?void 0:c.id),direct:!0})));const r={};for(const c of o)r[c.id]=c;o=Object.values(r)}return o},ws=async(s,t)=>{let e=null;const n=await fetch(`${I}/api/chat/completed`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(t)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),"detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},bs=async(s,t,e)=>{let n=null;const i=await fetch(`${I}/api/chat/actions/${t}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(e)}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>(console.error(o),"detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},ks=async(s,t)=>{let e=null;const n=await fetch(`${I}/api/tasks/stop/${t}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),"detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},Ts=async(s,t)=>{let e=null;const n=await fetch(`${I}/api/tasks/chat/${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),"detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},fs=async(s,t)=>{let e=null;const n=await fetch(`${t}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async o=>{if(t.toLowerCase().endsWith(".yaml")||t.toLowerCase().endsWith(".yml")){if(!o.ok)throw await o.text();const a=await o.text();return ls(a)}else{if(!o.ok)throw await o.json();return o.json()}}).catch(o=>(console.error(o),"detail"in o?e=o.detail:e=o,null));if(e)throw e;const i={openapi:n,info:n.info,specs:ot(n)};return console.log(i),i},Ss=async(s,t)=>(await Promise.all(t.filter(e=>{var n;return(n=e==null?void 0:e.config)==null?void 0:n.enable}).map(async e=>{const n=await fs(((e==null?void 0:e.auth_type)??"bearer")==="bearer"?e==null?void 0:e.key:localStorage.token,((e==null?void 0:e.path)??"").includes("://")?e==null?void 0:e.path:`${e==null?void 0:e.url}${((e==null?void 0:e.path)??"").startsWith("/")?"":"/"}${e==null?void 0:e.path}`).catch(i=>(St.error(s.t("Failed to connect to {{URL}} OpenAPI tool server",{URL:((e==null?void 0:e.path)??"").includes("://")?e==null?void 0:e.path:`${e==null?void 0:e.url}${((e==null?void 0:e.path)??"").startsWith("/")?"":"/"}${e==null?void 0:e.path}`})),null));if(n){const{openapi:i,info:o,specs:a}=n;return{url:e==null?void 0:e.url,openapi:i,info:o,specs:a}}}))).filter(e=>e),Ns=async(s,t,e,n,i)=>{let o=null;try{const a=Object.entries(i.openapi.paths).find(([w,k])=>Object.entries(k).some(([N,T])=>T.operationId===e));if(!a)throw new Error(`No matching route found for operationId: ${e}`);const[r,c]=a,l=Object.entries(c).find(([w,k])=>k.operationId===e);if(!l)throw new Error(`No matching method found for operationId: ${e}`);const[h,f]=l,d={},u={};let g={};f.parameters&&f.parameters.forEach(w=>{const k=w.name,N=w.in;n.hasOwnProperty(k)&&(N==="path"?d[k]=n[k]:N==="query"&&(u[k]=n[k]))});let p=`${t}${r}`;if(Object.entries(d).forEach(([w,k])=>{p=p.replace(new RegExp(`{${w}}`,"g"),encodeURIComponent(k))}),Object.keys(u).length>0){const w=new URLSearchParams(Object.entries(u).map(([k,N])=>[k,String(N)])).toString();p+=`?${w}`}if(f.requestBody&&f.requestBody.content){const w=Object.keys(f.requestBody.content)[0];if(n!==void 0)g=n;else throw new Error(`Request body expected for operation '${e}' but none found.`)}const m={"Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}};let b={method:h.toUpperCase(),headers:m};["post","put","patch"].includes(h.toLowerCase())&&f.requestBody&&(b.body=JSON.stringify(g));const S=await fetch(p,b);if(!S.ok){const w=await S.text();throw new Error(`HTTP error! Status: ${S.status}. Message: ${w}`)}return await S.json()}catch(a){return o=a.message,console.error("API Request Error:",o),{error:o}}},Is=async(s="")=>{let t=null;const e=await fetch(`${I}/api/v1/tasks/config`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(console.error(n),t=n,null));if(t)throw t;return e},As=async(s,t)=>{let e=null;const n=await fetch(`${I}/api/v1/tasks/config/update`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(t)}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),"detail"in i?e=i.detail:e=i,null));if(e)throw e;return n},$s=async(s="",t,e,n)=>{var a,r;let i=null;const o=await fetch(`${I}/api/v1/tasks/title/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:t,messages:e,...n})}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>(console.error(c),"detail"in c&&(i=c.detail),null));if(i)throw i;try{const l=(((r=(a=o==null?void 0:o.choices[0])==null?void 0:a.message)==null?void 0:r.content)??"").replace(/['‘’`]/g,'"'),h=l.indexOf("{"),f=l.lastIndexOf("}");if(h!==-1&&f!==-1){const d=l.substring(h,f+1),u=JSON.parse(d);return u&&u.title?u.title:null}return null}catch(c){return console.error("Failed to parse response: ",c),null}},Os=async(s="",t,e,n)=>{var a,r;let i=null;const o=await fetch(`${I}/api/v1/tasks/tags/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:t,messages:e,...n&&{chat_id:n}})}).then(async c=>{if(!c.ok)throw await c.json();return c.json()}).catch(c=>(console.error(c),"detail"in c&&(i=c.detail),null));if(i)throw i;try{const l=(((r=(a=o==null?void 0:o.choices[0])==null?void 0:a.message)==null?void 0:r.content)??"").replace(/['‘’`]/g,'"'),h=l.indexOf("{"),f=l.lastIndexOf("}");if(h!==-1&&f!==-1){const d=l.substring(h,f+1),u=JSON.parse(d);return u&&u.tags?Array.isArray(u.tags)?u.tags:[]:[]}return[]}catch(c){return console.error("Failed to parse response: ",c),[]}},_s=async(s="",t,e,n)=>{var r,c;let i=null;const o=await fetch(`${I}/api/v1/tasks/emoji/completions`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:t,prompt:e,...n&&{chat_id:n}})}).then(async l=>{if(!l.ok)throw await l.json();return l.json()}).catch(l=>(console.error(l),"detail"in l&&(i=l.detail),null));if(i)throw i;const a=((c=(r=o==null?void 0:o.choices[0])==null?void 0:r.message)==null?void 0:c.content.replace(/["']/g,""))??null;return a&&new RegExp("\\p{Extended_Pictographic}","u").test(a)?a.match(new RegExp("\\p{Extended_Pictographic}","gu"))[0]:null},Es=async(s="",t,e,n,i="search query")=>{var l,h;const o=new AbortController;let a=null;const r=await fetch(`${I}/api/v1/tasks/auto/completions`,{signal:o.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:t,prompt:e,...n&&{messages:n},type:i,stream:!1})}).then(async f=>{if(!f.ok)throw await f.json();return f.json()}).catch(f=>(console.error(f),"detail"in f&&(a=f.detail),null));if(a)throw a;const c=((h=(l=r==null?void 0:r.choices[0])==null?void 0:l.message)==null?void 0:h.content)??"";try{const f=c.indexOf("{"),d=c.lastIndexOf("}");if(f!==-1&&d!==-1){const u=c.substring(f,d+1),g=JSON.parse(u);return g&&g.text?g.text:""}return c}catch(f){return console.error("Failed to parse response: ",f),c}},js=async(s="",t,e,n)=>{const i=new AbortController;let o=null;const a=await fetch(`${I}/api/v1/tasks/moa/completions`,{signal:i.signal,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({model:t,prompt:e,responses:n,stream:!0})}).catch(r=>(console.error(r),o=r,null));if(o)throw o;return[a,i]},vs=async(s="")=>{let t=null;const e=await fetch(`${I}/api/v1/pipelines/list`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),t=i,null));if(t)throw t;return(e==null?void 0:e.data)??[]},Ls=async(s,t,e)=>{let n=null;const i=new FormData;i.append("file",t),i.append("urlIdx",e);const o=await fetch(`${I}/api/v1/pipelines/upload`,{method:"POST",headers:{...s&&{authorization:`Bearer ${s}`}},body:i}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(console.error(a),"detail"in a?n=a.detail:n=a,null));if(n)throw n;return o},Cs=async(s,t,e)=>{let n=null;const i=await fetch(`${I}/api/v1/pipelines/add`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify({url:t,urlIdx:e})}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>(console.error(o),"detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},Ps=async(s,t,e)=>{let n=null;const i=await fetch(`${I}/api/v1/pipelines/delete`,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify({id:t,urlIdx:e})}).then(async o=>{if(!o.ok)throw await o.json();return o.json()}).catch(o=>(console.error(o),"detail"in o?n=o.detail:n=o,null));if(n)throw n;return i},Bs=async(s,t)=>{let e=null;const n=new URLSearchParams;t!==void 0&&n.append("urlIdx",t);const i=await fetch(`${I}/api/v1/pipelines/?${n.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(console.error(a),e=a,null));if(e)throw e;return(i==null?void 0:i.data)??[]},Ds=async(s,t,e)=>{let n=null;const i=new URLSearchParams;e!==void 0&&i.append("urlIdx",e);const o=await fetch(`${I}/api/v1/pipelines/${t}/valves?${i.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(console.error(a),n=a,null));if(n)throw n;return o},Ks=async(s,t,e)=>{let n=null;const i=new URLSearchParams;e!==void 0&&i.append("urlIdx",e);const o=await fetch(`${I}/api/v1/pipelines/${t}/valves/spec?${i.toString()}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}}}).then(async a=>{if(!a.ok)throw await a.json();return a.json()}).catch(a=>(console.error(a),n=a,null));if(n)throw n;return o},Ms=async(s="",t,e,n)=>{let i=null;const o=new URLSearchParams;n!==void 0&&o.append("urlIdx",n);const a=await fetch(`${I}/api/v1/pipelines/${t}/valves/update?${o.toString()}`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",...s&&{authorization:`Bearer ${s}`}},body:JSON.stringify(e)}).then(async r=>{if(!r.ok)throw await r.json();return r.json()}).catch(r=>(console.error(r),"detail"in r?i=r.detail:i=r,null));if(i)throw i;return a},qs=async()=>{let s=null;const t=await fetch(`${I}/api/config`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(console.error(e),s=e,null));if(s)throw s;return t},Rs=async()=>{let s=null;const t=await fetch(`${I}/api/changelog`,{method:"GET",headers:{"Content-Type":"application/json"}}).then(async e=>{if(!e.ok)throw await e.json();return e.json()}).catch(e=>(console.error(e),s=e,null));if(s)throw s;return t},Us=async s=>{let t=null;const e=await fetch(`${I}/api/version/updates`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(console.error(n),t=n,null));if(t)throw t;return e},xs=async s=>{let t=null;const e=await fetch(`${I}/api/webhook`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}).then(async n=>{if(!n.ok)throw await n.json();return n.json()}).catch(n=>(console.error(n),t=n,null));if(t)throw t;return e.url},Fs=async(s,t)=>{let e=null;const n=await fetch(`${I}/api/webhook`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({url:t})}).then(async i=>{if(!i.ok)throw await i.json();return i.json()}).catch(i=>(console.error(i),e=i,null));if(e)throw e;return n.url};export{js as A,ws as B,qs as a,fs as b,Os as c,xs as d,Ns as e,Us as f,gs as g,vs as h,Ms as i,Ks as j,Ds as k,Bs as l,Cs as m,Ps as n,Ls as o,Is as p,As as q,$s as r,Ss as s,Rs as t,Fs as u,Es as v,_s as w,Ts as x,bs as y,ks as z};
//# sourceMappingURL=Bf7AzwKN.js.map
