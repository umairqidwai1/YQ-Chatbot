import{s as F,K as ie,q as ce,z as ue,B as fe,j as q,p as de,e as L,t as U,k as V,c as E,a as S,b as M,d as _,o as N,G as he,f as m,i as T,g as v,u as R,h as A,E as ee,F as te,n as ae}from"./jBEftbNB.js";import{S as G,i as J,b as K,d as Z,m as Q,t as W,a as z,e as X,f as me,g as _e,c as ge}from"./2lNU1ddO.js";import{a as pe,b as ke,u as se,e as le,f as be,h as Y,s as we,i as ve}from"./CDfCqrfx.js";import{l as re,m as ye,c as Ce}from"./BmtUElco.js";import{T as Ie}from"./Ciy_Y1cx.js";import{t as x}from"./CPRQqKui.js";import{k as Se}from"./DB_xkffJ.js";import{M as Te}from"./BUbv5-y6.js";import{L as Le}from"./BSjvF658.js";function Ee(l){let e,t;return e=new Ie({props:{tags:l[0]}}),e.$on("delete",l[4]),e.$on("add",l[5]),{c(){K(e.$$.fragment)},l(a){Z(e.$$.fragment,a)},m(a,s){Q(e,a,s),t=!0},p(a,[s]){const i={};s&1&&(i.tags=a[0]),e.$set(i)},i(a){t||(W(e.$$.fragment,a),t=!0)},o(a){z(e.$$.fragment,a),t=!1},d(a){X(e,a)}}}function Be(l,e,t){const a=ie();let{chatId:s=""}=e,i=[];const r=async()=>await pe(localStorage.token,s).catch(async d=>[]),o=async d=>{await ke(localStorage.token,s,d).catch(async f=>(x.error(`${f}`),null))&&(t(0,i=await r()),await se(localStorage.token,s,{tags:i}),await re.set(await le(localStorage.token)),a("add",{name:d}))},h=async d=>{await be(localStorage.token,s,d),t(0,i=await r()),await se(localStorage.token,s,{tags:i}),await re.set(await le(localStorage.token)),a("delete",{name:d})};ce(async()=>{s&&t(0,i=await r())});const y=d=>{h(d.detail)},C=d=>{o(d.detail)};return l.$$set=d=>{"chatId"in d&&t(3,s=d.chatId)},[i,o,h,s,y,C]}class Je extends G{constructor(e){super(),J(this,e,Be,Ee,F,{chatId:3})}}function ne(l){var B;let e,t,a,s,i,r,o,h,y,C,d,w,f;function g(n,u){return n[2].share_id?Me:Ue}let k=g(l),b=k(l),p=((B=l[4])==null?void 0:B.features.enable_community_sharing)&&oe(l);y=new Le({});function D(n,u){return n[2].share_id?Ae:De}let c=D(l),I=c(l);return{c(){e=L("div"),t=L("div"),b.c(),a=V(),s=L("div"),i=L("div"),r=L("div"),p&&p.c(),o=V(),h=L("button"),K(y.$$.fragment),C=V(),I.c(),this.h()},l(n){e=E(n,"DIV",{class:!0});var u=S(e);t=E(u,"DIV",{class:!0});var O=S(t);b.l(O),O.forEach(_),a=N(u),s=E(u,"DIV",{class:!0});var j=S(s);i=E(j,"DIV",{class:!0});var $=S(i);r=E($,"DIV",{class:!0});var H=S(r);p&&p.l(H),o=N(H),h=E(H,"BUTTON",{class:!0,type:!0,id:!0});var P=S(h);Z(y.$$.fragment,P),C=N(P),I.l(P),P.forEach(_),H.forEach(_),$.forEach(_),j.forEach(_),u.forEach(_),this.h()},h(){m(t,"class","text-sm dark:text-gray-300 mb-1"),m(h,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),m(h,"type","button"),m(h,"id","copy-and-share-chat-button"),m(r,"class","flex gap-1"),m(i,"class","flex flex-col items-end space-x-1 mt-3"),m(s,"class","flex justify-end"),m(e,"class","px-5 pt-4 pb-5 w-full flex flex-col justify-center")},m(n,u){T(n,e,u),v(e,t),b.m(t,null),v(e,a),v(e,s),v(s,i),v(i,r),p&&p.m(r,null),v(r,o),v(r,h),Q(y,h,null),v(h,C),I.m(h,null),d=!0,w||(f=R(h,"click",l[11]),w=!0)},p(n,u){var O;k===(k=g(n))&&b?b.p(n,u):(b.d(1),b=k(n),b&&(b.c(),b.m(t,null))),(O=n[4])!=null&&O.features.enable_community_sharing?p?p.p(n,u):(p=oe(n),p.c(),p.m(r,o)):p&&(p.d(1),p=null),c===(c=D(n))&&I?I.p(n,u):(I.d(1),I=c(n),I&&(I.c(),I.m(h,null)))},i(n){d||(W(y.$$.fragment,n),d=!0)},o(n){z(y.$$.fragment,n),d=!1},d(n){n&&_(e),b.d(),p&&p.d(),X(y),I.d(),w=!1,f()}}}function Ue(l){let e=l[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"",t;return{c(){t=U(e)},l(a){t=M(a,e)},m(a,s){T(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Messages you send after creating your link won't be shared. Users with the URL will be able to view the shared chat.")+"")&&A(t,e)},d(a){a&&_(t)}}}function Me(l){let e,t=l[3].t("You have shared this chat")+"",a,s,i,r=l[3].t("before")+"",o,h,y,C,d=l[3].t("Click here to")+"",w,f,g,k=l[3].t("delete this link")+"",b,p,D=l[3].t("and create a new shared link.")+"",c,I,B;return{c(){e=L("a"),a=U(t),s=V(),i=L("span"),o=U(r),h=U("."),C=V(),w=U(d),f=V(),g=L("button"),b=U(k),p=V(),c=U(D),this.h()},l(n){e=E(n,"A",{href:!0,target:!0});var u=S(e);a=M(u,t),s=N(u),i=E(u,"SPAN",{class:!0});var O=S(i);o=M(O,r),O.forEach(_),h=M(u,"."),u.forEach(_),C=N(n),w=M(n,d),f=N(n),g=E(n,"BUTTON",{class:!0});var j=S(g);b=M(j,k),j.forEach(_),p=N(n),c=M(n,D),this.h()},h(){m(i,"class","underline"),m(e,"href",y="/s/"+l[2].share_id),m(e,"target","_blank"),m(g,"class","underline")},m(n,u){T(n,e,u),v(e,a),v(e,s),v(e,i),v(i,o),v(e,h),T(n,C,u),T(n,w,u),T(n,f,u),T(n,g,u),v(g,b),T(n,p,u),T(n,c,u),I||(B=R(g,"click",l[9]),I=!0)},p(n,u){u&8&&t!==(t=n[3].t("You have shared this chat")+"")&&A(a,t),u&8&&r!==(r=n[3].t("before")+"")&&A(o,r),u&4&&y!==(y="/s/"+n[2].share_id)&&m(e,"href",y),u&8&&d!==(d=n[3].t("Click here to")+"")&&A(w,d),u&8&&k!==(k=n[3].t("delete this link")+"")&&A(b,k),u&8&&D!==(D=n[3].t("and create a new shared link.")+"")&&A(c,D)},d(n){n&&(_(e),_(C),_(w),_(f),_(g),_(p),_(c)),I=!1,B()}}}function oe(l){let e,t=l[3].t("Share to Open WebUI Community")+"",a,s,i;return{c(){e=L("button"),a=U(t),this.h()},l(r){e=E(r,"BUTTON",{class:!0,type:!0});var o=S(e);a=M(o,t),o.forEach(_),this.h()},h(){m(e,"class","self-center flex items-center gap-1 px-3.5 py-2 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full"),m(e,"type","button")},m(r,o){T(r,e,o),v(e,a),s||(i=R(e,"click",l[10]),s=!0)},p(r,o){o&8&&t!==(t=r[3].t("Share to Open WebUI Community")+"")&&A(a,t)},d(r){r&&_(e),s=!1,i()}}}function De(l){let e=l[3].t("Copy Link")+"",t;return{c(){t=U(e)},l(a){t=M(a,e)},m(a,s){T(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Copy Link")+"")&&A(t,e)},d(a){a&&_(t)}}}function Ae(l){let e=l[3].t("Update and Copy Link")+"",t;return{c(){t=U(e)},l(a){t=M(a,e)},m(a,s){T(a,t,s)},p(a,s){s&8&&e!==(e=a[3].t("Update and Copy Link")+"")&&A(t,e)},d(a){a&&_(t)}}}function Ve(l){let e,t,a,s=l[3].t("Share Chat")+"",i,r,o,h='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',y,C,d,w,f=l[2]&&ne(l);return{c(){e=L("div"),t=L("div"),a=L("div"),i=U(s),r=V(),o=L("button"),o.innerHTML=h,y=V(),f&&f.c(),this.h()},l(g){e=E(g,"DIV",{});var k=S(e);t=E(k,"DIV",{class:!0});var b=S(t);a=E(b,"DIV",{class:!0});var p=S(a);i=M(p,s),p.forEach(_),r=N(b),o=E(b,"BUTTON",{class:!0,"data-svelte-h":!0}),he(o)!=="svelte-745w2y"&&(o.innerHTML=h),b.forEach(_),y=N(k),f&&f.l(k),k.forEach(_),this.h()},h(){m(a,"class","text-lg font-medium self-center"),m(o,"class","self-center"),m(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-0.5")},m(g,k){T(g,e,k),v(e,t),v(t,a),v(a,i),v(t,r),v(t,o),v(e,y),f&&f.m(e,null),C=!0,d||(w=R(o,"click",l[8]),d=!0)},p(g,k){(!C||k&8)&&s!==(s=g[3].t("Share Chat")+"")&&A(i,s),g[2]?f?(f.p(g,k),k&4&&W(f,1)):(f=ne(g),f.c(),W(f,1),f.m(e,null)):f&&(_e(),z(f,1,1,()=>{f=null}),ge())},i(g){C||(W(f),C=!0)},o(g){z(f),C=!1},d(g){g&&_(e),f&&f.d(),d=!1,w()}}}function Ne(l){let e,t,a;function s(r){l[12](r)}let i={size:"md",$$slots:{default:[Ve]},$$scope:{ctx:l}};return l[0]!==void 0&&(i.show=l[0]),e=new Te({props:i}),ue.push(()=>me(e,"show",s)),{c(){K(e.$$.fragment)},l(r){Z(e.$$.fragment,r)},m(r,o){Q(e,r,o),a=!0},p(r,[o]){const h={};o&65567&&(h.$$scope={dirty:o,ctx:r}),!t&&o&1&&(t=!0,h.show=r[0],fe(()=>t=!1)),e.$set(h)},i(r){a||(W(e.$$.fragment,r),a=!0)},o(r){z(e.$$.fragment,r),a=!1},d(r){X(e,r)}}}function Oe(l,e,t){let a,s,i;q(l,ye,c=>t(14,a=c)),q(l,Ce,c=>t(4,i=c));let{chatId:r}=e,o=null,h=null;const y=de("i18n");q(l,y,c=>t(3,s=c));const C=async()=>{const c=await we(localStorage.token,r);return h=`${window.location.origin}/s/${c.id}`,console.log(h),t(2,o=await Y(localStorage.token,r)),h},d=async()=>{const c=o.chat;console.log("share",c),x.success(s.t("Redirecting you to Open WebUI Community"));const I="https://openwebui.com",B=await window.open(`${I}/chats/upload`,"_blank");window.addEventListener("message",n=>{n.origin===I&&n.data==="loaded"&&B.postMessage(JSON.stringify({chat:c,models:a.filter(u=>c.models.includes(u.id))}),"*")},!1)};let{show:w=!1}=e;const f=c=>o?c?o.id!==c.id||o.share_id!==c.share_id:!1:!0,g=()=>{t(0,w=!1)},k=async()=>{await ve(localStorage.token,r)&&t(2,o=await Y(localStorage.token,r))},b=()=>{d(),t(0,w=!1)},p=async()=>{if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){console.log("isSafari");const I=async()=>{const B=await C();return new Blob([B],{type:"text/plain"})};navigator.clipboard.write([new ClipboardItem({"text/plain":I()})]).then(()=>(console.log("Async: Copying to clipboard was successful!"),!0)).catch(B=>(console.error("Async: Could not copy text: ",B),!1))}else Se(await C());x.success(s.t("Copied shared chat URL to clipboard!")),t(0,w=!1)};function D(c){w=c,t(0,w)}return l.$$set=c=>{"chatId"in c&&t(1,r=c.chatId),"show"in c&&t(0,w=c.show)},l.$$.update=()=>{l.$$.dirty&7&&w&&(async()=>{if(r){const c=await Y(localStorage.token,r);f(c)&&t(2,o=c)}else t(2,o=null),console.log(o)})()},[w,r,o,s,i,y,C,d,g,k,b,p,D]}class Ke extends G{constructor(e){super(),J(this,e,Oe,Ne,F,{chatId:1,show:0})}}function We(l){let e,t;return{c(){e=ee("svg"),t=ee("path"),this.h()},l(a){e=te(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=S(e);t=te(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),S(t).forEach(_),s.forEach(_),this.h()},h(){m(t,"stroke-linecap","round"),m(t,"stroke-linejoin","round"),m(t,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"fill","none"),m(e,"viewBox","0 0 24 24"),m(e,"stroke-width",l[1]),m(e,"stroke","currentColor"),m(e,"class",l[0])},m(a,s){T(a,e,s),v(e,t)},p(a,[s]){s&2&&m(e,"stroke-width",a[1]),s&1&&m(e,"class",a[0])},i:ae,o:ae,d(a){a&&_(e)}}}function je(l,e,t){let{className:a="size-4"}=e,{strokeWidth:s="1.5"}=e;return l.$$set=i=>{"className"in i&&t(0,a=i.className),"strokeWidth"in i&&t(1,s=i.strokeWidth)},[a,s]}class Ze extends G{constructor(e){super(),J(this,e,je,We,F,{className:0,strokeWidth:1})}}export{Ze as P,Ke as S,Je as T};
//# sourceMappingURL=CXshsV65.js.map
